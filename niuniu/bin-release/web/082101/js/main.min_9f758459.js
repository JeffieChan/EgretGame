var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(s,o){function a(t){try{h(n.next(t))}catch(e){o(e)}}function r(t){try{h(n["throw"](t))}catch(e){o(e)}}function h(t){t.done?s(t.value):new i(function(e){e(t.value)}).then(a,r)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(s)throw new TypeError("Generator is already executing.");for(;h;)try{if(s=1,o&&(a=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,o=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],o=0}finally{s=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,o,a,r,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},GameScenes;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i}return __extends(e,t),e.prototype.initStyle=function(){this.drawBg()},e.prototype.drawBg=function(){var t=new egret.Shape;t.graphics.beginFill(this.setting.bgColor,this.setting.alpha),t.graphics.drawRect(0,0,Settings.GameSettingUtils.gameSetting.globalWidth,this.stage.stageHeight),t.graphics.endFill(),this.addFixedChild(t);var e=CommonUtils.BitmapUtils.createBitmapByName(this.setting.icon);this.addFixedChild(e),e.x=(Settings.GameSettingUtils.gameSetting.globalWidth-e.width)/2*Settings.GameSettingUtils.globalScale,e.y=(this.stage.stageHeight-e.height)/2*Settings.GameSettingUtils.globalScale},e.prototype.addFixedChild=function(t){this.addChild(t),t.scaleX=Settings.GameSettingUtils.globalScale,t.scaleY=Settings.GameSettingUtils.globalScale,t.x=t.x*Settings.GameSettingUtils.globalScale,t.y=t.y*Settings.GameSettingUtils.globalScale},e.prototype.addFixedToBottomChild=function(t){t.scaleX=Settings.GameSettingUtils.globalScale,t.scaleY=Settings.GameSettingUtils.globalScale,t.x=t.x*Settings.GameSettingUtils.globalScale,t.y=this.height-t.y*Settings.GameSettingUtils.globalScale},e}(egret.DisplayObjectContainer);t.OtherBaseScene=e,__reflect(e.prototype,"GameScenes.OtherBaseScene")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i}return __extends(e,t),e.prototype.initStyle=function(){this.drawBg()},e.prototype.drawBg=function(){var t=new egret.Shape;t.graphics.beginFill(this.setting.bgColor,this.setting.alpha),t.graphics.drawRect(0,0,Settings.GameSettingUtils.gameSetting.globalWidth,Settings.GameSettingUtils.gameSetting.globalHeight),t.graphics.endFill(),this.addFixedChild(t)},e.prototype.addFixedChild=function(t){this.addChild(t),t.scaleX=Settings.GameSettingUtils.globalScale,t.scaleY=Settings.GameSettingUtils.globalScale,t.x=t.x*Settings.GameSettingUtils.globalScale,t.y=t.y*Settings.GameSettingUtils.globalScale},e.prototype.addFixedToBottomChild=function(t){t.scaleX=Settings.GameSettingUtils.globalScale,t.scaleY=Settings.GameSettingUtils.globalScale,t.x=t.x*Settings.GameSettingUtils.globalScale,t.y=this.height-t.y*Settings.GameSettingUtils.globalScale},e}(egret.DisplayObjectContainer);t.RootScene=e,__reflect(e.prototype,"GameScenes.RootScene")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getPresenter=function(){return this.presenter},e.prototype.setUserToken=function(t){this.presenter.setUserToken(t)},e.prototype.initStyle=function(){t.prototype.initStyle.call(this),this.drawTitle(this.setting.title)},e.prototype.drawTitle=function(t){this.title=new SceneTitle(t,this.setting.closeIcon),this.addFixedChild(this.title)},e}(t.OtherBaseScene);t.OtherScene=e,__reflect(e.prototype,"GameScenes.OtherScene")}(GameScenes||(GameScenes={}));var SceneTitle=function(t){function e(e,i){var n=t.call(this)||this;return n.setting=e,n.extraData=i,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){var t=this;this.cacheAsBitmap=!0;var e=new egret.TextField;e.textColor=this.setting.textColor,e.size=this.setting.textSize,e.width=Settings.GameSettingUtils.gameSetting.globalWidth,e.height=this.setting.titleHeight,e.textAlign=egret.HorizontalAlign.CENTER,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.text=this.getTitleText(),this.addChild(e),e.y=this.setting.top+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2;var i=CommonUtils.BitmapUtils.createBitmapByName("关闭按钮_png");this.addChild(i),i.x=633,i.y=130+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameScenes.GameSceneManger.destoryScene(t.parent)},this)},e.prototype.getTitleText=function(){var t=this.setting.titleText;if(!this.extraData)return t;for(var e in this.extraData){var i=e.toString(),n="#"+i+"#";t=t.replace(n,this.extraData[e])}return t},e}(egret.DisplayObjectContainer);__reflect(SceneTitle.prototype,"SceneTitle");var GameScenes;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getPresenter=function(){return this.presenter},e.prototype.setUserToken=function(t){this.presenter.setUserToken(t)},e.prototype.initStyle=function(){t.prototype.initStyle.call(this),this.drawTitle(this.setting.title)},e.prototype.drawTitle=function(t){this.title=new i(t,this.extraData),this.addFixedChild(this.title)},e}(t.RootScene);t.BaseScene=e,__reflect(e.prototype,"GameScenes.BaseScene");var i=function(t){function e(e,i){var n=t.call(this)||this;return n.setting=e,n.extraData=i,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){var t=new egret.Shape;t.graphics.beginFill(this.setting.titleBgColor,this.setting.titleBgAlpha),t.graphics.drawRect(0,0,Settings.GameSettingUtils.gameSetting.globalWidth,this.setting.titleHeight),this.addChild(t);var e=new egret.TextField;e.textColor=this.setting.textColor,e.size=this.setting.textSize,e.width=Settings.GameSettingUtils.gameSetting.globalWidth,e.height=this.setting.titleHeight,e.textAlign=egret.HorizontalAlign.CENTER,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.text=this.getTitleText(),this.addChild(e);var i=CommonUtils.BitmapUtils.createBitmapByName("");this.addChild(i),i.x=30,i.y=(this.height-i.height)/2,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this)},e.prototype.getTitleText=function(){var t=this.setting.titleText;if(!this.extraData)return t;for(var e in this.extraData){var i=e.toString(),n="#"+i+"#";t=t.replace(n,this.extraData[e])}return t},e}(egret.DisplayObjectContainer);__reflect(i.prototype,"SceneTitle")}(GameScenes||(GameScenes={}));var Server;!function(t){var e;!function(t){t[t.Disconnected=0]="Disconnected",t[t.Connecting=1]="Connecting",t[t.Connedted=2]="Connedted"}(e=t.ClientState||(t.ClientState={}));var i=function(){function i(){this.initCallback=null,this.socket=null,this.callbacks={},this.eventCallbacks={},this.reqId=1,this.State=e.Disconnected}return i.prototype.on=function(t,e){(this.eventCallbacks[t]=this.eventCallbacks[t]||[]).push(e)},i.prototype.init=function(t,i){this.State=e.Connecting,this.initCallback=i;var n=t.host,s=t.port;this.initWebSocket(n,s)},i.prototype.close=function(){this.socket.flush(),this.socket.close()},i.prototype.reConnect=function(t,e,i){this.init({host:t,port:e},i)},i.prototype.isConnected=function(){return console.log("socket connected: "+this.socket.connected),this.socket.connected},i.prototype.initWebSocket=function(t,e){console.log("[Pomelo] connect to:",t,e),this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_STRING,this.socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this.socket.addEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onMessage,this),this.socket.connect(t,e)},i.prototype.onConnect=function(t){this.State=e.Connedted,console.log("[Pomelo] connect success",t),this.initCallback(!0)},i.prototype.onClose=function(t){console.error("[Pomelo] connect close:",t),this.emit(i.EVENT_CLOSE,t)},i.prototype.onIOError=function(t){console.error("socket error: ",t),this.emit(i.EVENT_IO_ERROR,t)},i.prototype.onMessage=function(t){var e=this.socket.readUTF();console.log((new Date).toString()+"收到服务器端的消息："+e);var i=JSON.parse(e);this.processMessage(i)},i.prototype.processMessage=function(e){if(!e.ReqId||0==e.ReqId)return t.GateClient.DEBUG&&(console.group("EVENT:"),console.info("Route:",e.ReqId),console.info("Msg:",e.Data),console.groupEnd()),void this.emit(e.Route,e.Data);t.GateClient.DEBUG&&(console.group("RESPONSE:"),console.info("Id:",e.ReqId),console.info("Msg:",e.Data),console.groupEnd());var i=this.callbacks[e.ReqId];if(delete this.callbacks[e.ReqId],"function"==typeof i){if(500==e.Code){e.Data=e.Data}i(e)}},i.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=[].slice.call(arguments,1),s=this.eventCallbacks[t];if(s){s=s.slice(0);for(var o=0,a=s.length;a>o;++o)s[o].apply(this,n)}return this},i.prototype.request=function(t,e){this.reqId++,this.reqId>i.MAX_REQ_COUNT&&(this.reqId=1);var n=this.reqId;t.reqId=n,i.DEBUG&&(console.group("REQUEST:"),console.log("Id:",n),console.log("Param:",t),console.groupEnd()),this.socket&&this.socket.connected&&(this.socket.writeUTF(JSON.stringify(t)),this.socket.flush()),this.callbacks[n]=e},i.EVENT_IO_ERROR="io-error",i.EVENT_CLOSE="close",i.EVENT_KICK="onKick",i.EVENT_HEART_BEAT_TIMEOUT="heartbeat timeout",i.DEBUG=!0,i.MAX_REQ_COUNT=255,i}();t.BaseClient=i,__reflect(i.prototype,"Server.BaseClient")}(Server||(Server={}));var GameScenes;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.presenter=new t.HelpPresenter(n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(i,e),i.prototype.onAddToStage=function(t){this.initStyle(),this.drawContent()},i.prototype.drawContent=function(){var t=new egret.TextField;t.size=24,t.textColor=11038013,t.textAlign=egret.HorizontalAlign.LEFT,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.fontFamily="苹方",t.text="1.10、J、Q、K记为10，其他按牌面数字计算，无大小王。\n\n\n2.每个常规投注区和庄家将获得5张牌，若有3张牌之和为10的整数倍，则其余两张之和的个位数为该副牌的牛数。\n\n\n3.玩家可以在不同的投注区投注，庄家不可投注，投注区1/2/3按照牛牛的规则获得盈利，混合投注区1/2获胜只得到1倍盈利。\n\n\n4.混合投注区1的获胜判定为：投注区123中有两家比庄家大，则获胜；混合投注区2获胜判定为：投注区12中有一家比庄家大，若一胜一负，则返还投注的数量。\n\n\n5.若玩家的金额低于最小投注额的5倍时，则无法进行投注，投注过程中，投注金额不能超出赔付金额的5倍。\n\n\n6.庄家和投注区同牌型时，挑出最大的一张牌进行大小比较，若最大的牌也是一样大，则按照黑、红、梅、方的排列必出大小\n\n\n7.无牛~牛6为1倍，牛7为2倍，牛8为3倍，牛9为4倍，牛牛为5倍",t.width=600;var e=new egret.ScrollView;this.addFixedChild(e),e.setContent(t),e.y=333+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,e.x=87,e.width=603,e.horizontalScrollPolicy="off",e.verticalScrollPolicy="on",e.height=695},i}(t.OtherScene);t.HelpScene=e,__reflect(e.prototype,"GameScenes.HelpScene")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.pokerPadding=30,i.resultPaddingTop=70,i.resultPaddingTop1=80,i.positionViewTitleHeight=35,i.presenter=new t.PlayTablePresenter(i),i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(i,e),i.prototype.onAddToStage=function(){this.presenter.init(),this.presenter.startEnterGameServer()},i.prototype.initView=function(){this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.frameArr=[new egret.Point(392,194),new egret.Point(34.5,712),new egret.Point(279.5,991),new egret.Point(520.5,712)],this.positionArr=[],this.positionArr[0]=null,this.results=new Array,this.betList=new Array,this.myBetList=new Array,this.betAddNumTimer=new egret.Timer(100,10),this.otherBelList=new Array,this.lastBetList=new Array,this.canPutBet=!0},i.prototype.drawScene=function(t){this.contains(this.bg)||this.drawPlaytableBg(),this.contains(this.playTableTitle)||this.drawPlaytableTitle(),this.contains(this.helpBtn)||this.drawHelpBtn(),this.contains(this.trendBtn)||this.drawtrendBtn(),this.contains(this.recordBtn)||this.drawRecordBtn(),this.contains(this.onLineIcon)||this.drawOnLineIcon(),this.contains(this.host)||this.drawHost(),this.contains(this.betStatisticsUI)||this.drawBetStatisticsUI(),this.contains(this.ownBetNumUI)||this.drawOwnBetNumUI(),this.contains(this.playerQL)||this.drawPlayerQL(),this.contains(this.playerBH)||this.drawPlayerBH(),this.contains(this.playerXW)||this.drawPlayerXW(),this.contains(this.playerX)||this.drawPlayerX(),this.contains(this.playerQ)||this.drawPlayerQ(),this.contains(this.countDownTimer)||this.drawCountDownTimer(),this.contains(this.alert)||this.drawAlert(),this.contains(this.betCoinContainer)||this.drawBetCoinContainer(),this.contains(this.playDiceUI)||this.createDiceUI(),this.contains(this.shuffleUI)||this.createShufflePokerUI(),this.contains(this.betAddBitmapText)||this.createBetAddUI(),this.contains(this.serverConnectView)||this.drawBetAlert(),this.contains(this.wantageAlert)||this.drawWantageAlert(),this.contains(this.connectErrorView)||this.drawConnectErrorView(),this.contains(this.betView)||this.drawBetView()},i.prototype.drawPlaytableBg=function(){this.bg=CommonUtils.BitmapUtils.createBitmapByName("bg2_jpg"),this.addFixedChild(this.bg),this.bg.x=(this.stage.stageWidth-this.bg.width)/2,this.setChildIndex(this.bg,0)},i.prototype.drawPlaytableTitle=function(){this.playTableTitle=new t.PlayTable.TitleUI(Settings.GameSettingUtils.gameSetting.title),this.addFixedChild(this.playTableTitle),this.setChildIndex(this.playTableTitle,1)},i.prototype.drawHelpBtn=function(){this.helpBtn=new t.PlayTable.IconUI(Settings.GameSettingUtils.gameSetting.helpBtn),this.addFixedChild(this.helpBtn),this.setChildIndex(this.helpBtn,1)},i.prototype.drawtrendBtn=function(){this.trendBtn=new t.PlayTable.IconUI(Settings.GameSettingUtils.gameSetting.trendBtn),this.addFixedChild(this.trendBtn),this.setChildIndex(this.trendBtn,1)},i.prototype.drawRecordBtn=function(){this.recordBtn=new t.PlayTable.IconUI(Settings.GameSettingUtils.gameSetting.recordBtn),this.addFixedChild(this.recordBtn),this.setChildIndex(this.recordBtn,1)},i.prototype.drawHost=function(){this.host=new t.PlayTable.IconUI(Settings.GameSettingUtils.gameSetting.host),this.addFixedChild(this.host),this.hostCover=CommonUtils.BitmapUtils.createBitmapByName("发牌方遮罩_png"),this.addFixedChild(this.hostCover),this.hostCover.x=this.host.icon.x-10,this.hostCover.y=this.host.icon.y-10,this.hostCover.width=this.host.icon.width+20,this.hostCover.height=this.host.icon.height+20,this.hostCover.visible=!1,this.setChildIndex(this.host,1),this.setChildIndex(this.hostCover,2)},i.prototype.drawOnLineIcon=function(){this.onLineIcon=new t.PlayTable.OnlineUI(Settings.GameSettingUtils.gameSetting.onLineIcon),this.addFixedChild(this.onLineIcon),this.setChildIndex(this.onLineIcon,1)},i.prototype.drawBetStatisticsUI=function(){this.betStatisticsUI=new t.PlayTable.BetStatisticsUI(Settings.GameSettingUtils.gameSetting.betStatistics),this.addFixedChild(this.betStatisticsUI),this.setChildIndex(this.betStatisticsUI,1)},i.prototype.drawOwnBetNumUI=function(){this.ownBetNumUI=new t.PlayTable.BetNumUI(Settings.GameSettingUtils.gameSetting.ownBetNum),this.addFixedChild(this.ownBetNumUI),this.setChildIndex(this.ownBetNumUI,1)},i.prototype.drawPlayerQL=function(){this.playerQL=new t.PlayTable.PlayerPosition(Settings.GameSettingUtils.gameSetting.playerQL),this.addFixedChild(this.playerQL),this.positionArr[1]=this.playerQL,this.setChildIndex(this.playerQL,1)},i.prototype.drawPlayerXW=function(){this.playerXW=new t.PlayTable.PlayerPosition(Settings.GameSettingUtils.gameSetting.playerXW),this.addFixedChild(this.playerXW),this.positionArr[2]=this.playerXW,this.setChildIndex(this.playerXW,1)},i.prototype.drawPlayerBH=function(){this.playerBH=new t.PlayTable.PlayerPosition(Settings.GameSettingUtils.gameSetting.playerBH),this.addFixedChild(this.playerBH),this.positionArr[3]=this.playerBH,this.setChildIndex(this.playerBH,1)},i.prototype.drawPlayerX=function(){this.playerX=new t.PlayTable.PlayerPosition(Settings.GameSettingUtils.gameSetting.playerX),this.addFixedChild(this.playerX),this.positionArr[5]=this.playerX,this.setChildIndex(this.playerX,1)},i.prototype.drawPlayerQ=function(){this.playerQ=new t.PlayTable.PlayerPosition(Settings.GameSettingUtils.gameSetting.playerQ),this.addFixedChild(this.playerQ),this.positionArr[4]=this.playerQ,this.setChildIndex(this.playerQ,1)},i.prototype.drawCountDownTimer=function(){this.countDownTimer=new t.PlayTable.CountDownTimer(Settings.GameSettingUtils.gameSetting.countDownTimer),this.addFixedChild(this.countDownTimer),this.setChildIndex(this.countDownTimer,200),this.countDownTimer.visible=!1},i.prototype.drawWantageAlert=function(){this.wantageAlert=new egret.TextField,this.addFixedChild(this.wantageAlert),this.wantageAlert.size=24,this.wantageAlert.textColor=16777215,this.wantageAlert.textAlign=egret.HorizontalAlign.CENTER,this.wantageAlert.verticalAlign=egret.VerticalAlign.MIDDLE,this.wantageAlert.fontFamily="苹方",this.wantageAlert.x=264,this.wantageAlert.y=1143,this.wantageAlert.visible=!1},i.prototype.showWantageAlert=function(t){this.wantageAlert.visible=!0,this.wantageAlert.textFlow=[{text:"金额大于",style:{textColor:16777215}},{text:(100*t-1).toString(),style:{textColor:16766977}},{text:"才可以投注呦~",style:{textColor:16777215}}]},i.prototype.hideWantageAlert=function(){this.wantageAlert.visible=!1},i.prototype.showPlyerCover=function(t){switch(t){case 0:this.hostCover.visible=!0;break;case 1:this.playerQL.cover.visible=!0;break;case 2:this.playerXW.cover.visible=!0;break;case 3:this.playerBH.cover.visible=!0}},i.prototype.hidePlayerCover=function(){this.hostCover.visible=!1,this.playerQL.cover.visible=!1,this.playerXW.cover.visible=!1,this.playerBH.cover.visible=!1},i.prototype.drawAlert=function(){this.alert=new t.PlayTable.Alert(Settings.GameSettingUtils.gameSetting.alert),this.addChild(this.alert),this.alert.visible=!1,this.setChildIndex(this.alert,21)},i.prototype.drawBetAlert=function(){this.serverConnectView=new ConnectingUI,this.addFixedChild(this.serverConnectView),this.serverConnectView.y=(this.stage.height-this.serverConnectView.height)/2,this.serverConnectView.visible=!1,this.setChildIndex(this.serverConnectView,100)},i.prototype.createDiceUI=function(){this.playDiceUI=new t.PlayTable.PlayDice(Settings.GameSettingUtils.gameSetting.dice),this.addFixedChild(this.playDiceUI)},i.prototype.createShufflePokerUI=function(){this.shuffleUI=new t.PlayTable.Shuuffle(Settings.GameSettingUtils.gameSetting.shuffle,this),this.addFixedChild(this.shuffleUI)},i.prototype.drawPokerBg=function(){this.contains(this.pokerBg)||(this.pokerBg=new t.PlayTable.PokerBg(Settings.GameSettingUtils.gameSetting.poker),this.addFixedChild(this.pokerBg),this.setChildIndex(this.pokerBg,10),this.results.push(this.pokerBg))},i.prototype.drawBetCoinContainer=function(){this.betCoinContainer=new t.PlayTable.BetCoinContainerUI,this.addFixedChild(this.betCoinContainer),this.betCoinContainer.x=0,this.betCoinContainer.y=this.stage.stageHeight-this.betCoinContainer.height,this.betCoinContainer.loadCoins()},i.prototype.sendCard=function(t,e){var i=this.frameArr[e];this.pokerBg.dealCard(t,i)},i.prototype.openCard=function(t,e){if(this.setChildIndex(this.pokerBg,10),e&&e.CardList&&0!=e.CardList.length){for(var i,n,s=this.frameArr[t],o=(e.CardList,e.CardLevel,0);o<e.CardList.length;o++){var a=e.CardList[o],r=CommonUtils.BitmapUtils.createBitmapByName(a.Color.toString()+"_"+a.Num.toString()+"_png");this.addFixedChild(r),r.x=s.x+o*this.pokerPadding,r.y=s.y,i=r.height,n=r.width,this.results.push(r),this.setChildIndex(r,16+o)}var h=CommonUtils.BitmapUtils.createBitmapByName(e.CardLevel+"_png");this.addFixedChild(h),this.setChildIndex(h,21),h.x=s.x+(4*this.pokerPadding+n-h.width)/2,h.y=s.y+r.height-h.height,"牛牛"==e.CardLevel&&(h.y=s.y+r.height-h.height+10),this.results.push(h)}},i.prototype.showResult=function(t,e){if(null!=t){var i=this.positionArr[e];if(null!=i){var n=CommonUtils.BitmapUtils.createBitmapByName(t+"_png");this.addFixedChild(n),this.setChildIndex(n,22),n.x=i.bitmap.x+(i.bitmap.width-n.width)/2,5==e?n.y=i.bitmap.y+this.resultPaddingTop:n.y=i.bitmap.y+this.resultPaddingTop1,this.results.push(n)}}},i.prototype.cleanPlayTableSence=function(){for(;this.results.length>0;){var t=this.results.pop();if(null==t)break;this.contains(t)&&this.removeChild(t)}for(;this.myBetList.length>0;){var e=this.myBetList.pop();if(null==e)break;this.betView.contains(e.bet)&&this.betView.removeChild(e.bet)}for(;this.otherBelList.length>0;){var e=this.otherBelList.pop();if(null==e)break;this.betView.contains(e.bet)&&this.betView.removeChild(e.bet)}for(;this.lastBetList.length>0;){var e=this.lastBetList.pop();if(null==e)break;this.betView.contains(e.bet)&&this.betView.removeChild(e.bet)}},i.prototype.startPutBet=function(){for(;this.myBetList.length>0;)this.myBetList.pop();for(;this.otherBelList.length>0;)this.otherBelList.pop();this.canPutBet&&this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.putBet,this)},i.prototype.drawBetView=function(){this.betView=new egret.DisplayObjectContainer,this.addFixedChild(this.betView),this.setChildIndex(this.betView,6)},i.prototype.putBet=function(t){for(;this.betList.length>0;)this.betList.pop();if(this.betCoinContainer.betNum)for(var e=1;6>e;e++){var i=this.positionArr[e],n=new TransmissionPackage.BetItem;if(i.hitTestPoint(t.stageX,t.stageY,!0)){switch(this.betCoinContainer.betNum){case 100:this.bet=CommonUtils.BitmapUtils.createBitmapByName("小100_png");break;case 500:this.bet=CommonUtils.BitmapUtils.createBitmapByName("小500_png");break;case 1e3:this.bet=CommonUtils.BitmapUtils.createBitmapByName("小1000_png");break;case 5e3:this.bet=CommonUtils.BitmapUtils.createBitmapByName("小5000_png")}this.bet.anchorOffsetX=this.bet.width/2,this.bet.anchorOffsetY=this.bet.height/2,this.bet.x=this.ownBetNumUI.betNumTF.x,this.bet.y=this.ownBetNumUI.betNumTF.y,this.bet.rotation=360*Math.random(),this.betX=t.stageX,this.betY=t.stageY,this.betX<=i.bitmap.x+this.bet.width/2&&[this.betX=i.bitmap.x+this.bet.width/2],this.betX>=i.bitmap.x+i.bitmap.width-this.bet.width/2&&(this.betX=i.bitmap.x+i.bitmap.width-this.bet.width/2),this.betY<=i.bitmap.y+this.bet.height/2+this.positionViewTitleHeight&&(this.betY=i.bitmap.y+this.bet.height/2+this.positionViewTitleHeight),this.betY>=i.bitmap.y+i.bitmap.height-this.bet.width/2&&(this.betY=i.bitmap.y+i.bitmap.height-this.bet.width/2),this.optionId=e,n.OptionId=e,n.BetNumber=this.betCoinContainer.betNum,this.lastBetNum=this.betCoinContainer.betNum,this.betList.push(n),this.presenter.startBeting(this.betList)}}},i.prototype.putBetOn=function(){this.betView.addChild(this.bet),egret.Tween.get(this.bet).to({x:this.betX,y:this.betY},300);var t=new Model.BetModel;t.optionId=this.optionId-1,t.bet=this.bet,this.myBetList.push(t)},i.prototype.putOtherBetOn=function(t){for(var e,i,n=this,s=1;6>s;s++){var o=this.positionArr[s],a=t[s-1];i=new Model.BetModel,i.optionId=s-1,a.forEach(function(t){e=CommonUtils.BitmapUtils.createBitmapByName("小"+t+"_png"),n.betView.addChild(e),e.x=n.onLineIcon.icon.x,e.y=n.onLineIcon.icon.y;var s=o.bitmap.x+Math.random()*(o.bitmap.width-2*e.width),a=o.bitmap.y+n.positionViewTitleHeight+Math.random()*(o.bitmap.height-2*e.height-n.positionViewTitleHeight);egret.Tween.get(e).to({x:s,y:a},300),i.bet=e,n.otherBelList.push(i)})}},i.prototype.drawBet=function(t){for(var e,i,n=this,s=1;6>s;s++){var o=this.positionArr[s],a=t[s-1];a.BetNumberList.forEach(function(t){e=CommonUtils.BitmapUtils.createBitmapByName("小"+t+"_png"),n.betView.addChild(e),e.x=o.bitmap.x+Math.random()*(o.bitmap.width-2*e.width),e.y=o.bitmap.y+n.positionViewTitleHeight+Math.random()*(o.bitmap.height-2*e.height-n.positionViewTitleHeight),i=new Model.BetModel,i.optionId=s-1,i.bet=e,n.lastBetList.push(i)}),a.MyBetNumberList.forEach(function(t){e=CommonUtils.BitmapUtils.createBitmapByName("小"+t+"_png"),n.betView.addChild(e),e.x=o.bitmap.x+e.width+Math.random()*(o.bitmap.width-2*e.width),e.y=o.bitmap.y+n.positionViewTitleHeight+Math.random()*(o.bitmap.height-2*e.height-n.positionViewTitleHeight),i=new Model.BetModel,i.optionId=s-1,i.bet=e,n.lastBetList.push(i)})}},i.prototype.betAnimation=function(t,e){for(var i=this,n=0;n<e.length;n++){var s=e[n];"负"==s?(this.myBetList.forEach(function(t){t.optionId==n&&egret.Tween.get(t.bet).wait(Settings.GameSettingUtils.timeSetting.betWaitInterval).to({x:i.host.icon.x+i.host.width/2,y:i.host.icon.y+i.host.height},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){i.betView.contains(t.bet)&&i.betView.removeChild(t.bet)})}),this.otherBelList.forEach(function(t){t.optionId==n&&egret.Tween.get(t.bet).wait(Settings.GameSettingUtils.timeSetting.betWaitInterval).to({x:i.host.icon.x+i.host.width/2,y:i.host.icon.y+i.host.height},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){i.betView.contains(t.bet)&&i.betView.removeChild(t.bet)})}),this.lastBetList.forEach(function(t){t.optionId==n&&egret.Tween.get(t.bet).wait(Settings.GameSettingUtils.timeSetting.betWaitInterval).to({x:i.host.icon.x+i.host.width/2,y:i.host.icon.y+i.host.height},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){i.betView.contains(t.bet)&&i.betView.removeChild(t.bet)})})):(this.myBetList.forEach(function(t){t.optionId==n&&egret.Tween.get(t.bet).wait(Settings.GameSettingUtils.timeSetting.betWaitInterval).to({x:i.ownBetNumUI.betNumTF.x,y:i.ownBetNumUI.betNumTF.y},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){i.betView.contains(t.bet)&&i.betView.removeChild(t.bet)})}),this.otherBelList.forEach(function(t){t.optionId==n&&egret.Tween.get(t.bet).wait(Settings.GameSettingUtils.timeSetting.betWaitInterval).to({x:i.onLineIcon.icon.x,y:i.onLineIcon.icon.y},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){i.betView.contains(t.bet)&&i.betView.removeChild(t.bet)})}),this.lastBetList.forEach(function(t){t.optionId==n&&egret.Tween.get(t.bet).wait(Settings.GameSettingUtils.timeSetting.betWaitInterval).to({x:i.onLineIcon.icon.x,y:i.onLineIcon.icon.y},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){i.betView.contains(t.bet)&&i.betView.removeChild(t.bet)})}))}t>0&&this.betAddAnimation(t)},i.prototype.createBetAddUI=function(){this.betAddBitmapText=new egret.BitmapText,this.addFixedChild(this.betAddBitmapText),this.betAddBitmapText.font=CommonUtils.BitmapFontUtils.createBitmapFontByName(Settings.GameSettingUtils.gameSetting.bitmapTextFont),this.betAddBitmapText.text="",this.betAddBitmapText.visible=!1},i.prototype.betAddAnimation=function(t){var e=this;this.betAddBitmapText.visible=!0,this.betAddBitmapText.text="+"+t.toString(),this.betAddBitmapText.x=this.ownBetNumUI.betNumTF.x,this.betAddBitmapText.y=this.ownBetNumUI.bg.y-this.betAddBitmapText.height,this.betAddBitmapText.alpha=1,this.setChildIndex(this.betAddBitmapText,35),this.betAddNumTimer.addEventListener(egret.TimerEvent.TIMER,function(){e.betAddBitmapText.alpha-=.1},this),egret.Tween.get(this.betAddBitmapText).wait(2*Settings.GameSettingUtils.timeSetting.betWaitInterval+Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){e.betAddNumTimer.reset(),e.betAddNumTimer.start()}).to({x:this.betAddBitmapText.x,y:this.betAddBitmapText.y-100},Settings.GameSettingUtils.timeSetting.settleInterval).call(function(){e.betAddBitmapText.visible=!1,e.betAddBitmapText.x=e.ownBetNumUI.betNumTF.x+e.ownBetNumUI.betNumTF.width,e.betAddBitmapText.y=e.ownBetNumUI.bg.y-e.betAddBitmapText.height})},i.prototype.showPlayerBetInfo=function(t){for(var e=0;5>e;e++)switch(e){case 0:this.betStatisticsUI.player1TF.setBetNum(t[0]);break;case 1:this.betStatisticsUI.player2TF.setBetNum(t[2]);break;case 2:this.betStatisticsUI.player3TF.setBetNum(t[1]);break;case 3:this.betStatisticsUI.player4TF.setBetNum(t[4]);break;case 4:this.betStatisticsUI.player5TF.setBetNum(t[3])}},i.prototype.showTotleBetInfo=function(t){for(var e=0;5>e;e++)switch(e){case 0:this.playerQL.setTotleBet(t[0]);break;case 1:this.playerBH.setTotleBet(t[2]);break;case 2:this.playerXW.setTotleBet(t[1]);break;case 3:this.playerX.setTotleBet(t[4]);break;case 4:this.playerQ.setTotleBet(t[3])}},i.prototype.showInfo=function(t,e){this.alert.visible=!0,this.alert.showBitmapTextContent(t,e)},i.prototype.showStartBet=function(){this.alert.visible=!0,this.alert.showStartBet();var t=new egret.Timer(Settings.GameSettingUtils.timeSetting.alertWaitInterval,1);t.addEventListener(egret.TimerEvent.TIMER,this.removeAlert,this),t.start()},i.prototype.showBet=function(){var t=this;this.serverConnectView.setConnectText("游戏进行中，请开始投注"),this.serverConnectView.visible=!0;var e=new egret.Timer(Settings.GameSettingUtils.timeSetting.alertWaitInterval,1);e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){t.serverConnectView.visible=!1},this),e.start()},i.prototype.showNotEnough=function(){var t=this;this.serverConnectView.setConnectText("余额不足"),this.serverConnectView.visible=!0;var e=new egret.Timer(Settings.GameSettingUtils.timeSetting.alertWaitInterval,1);e.once(egret.TimerEvent.TIMER_COMPLETE,function(){t.serverConnectView.visible=!1},this),e.start()},i.prototype.showStopBet=function(){this.alert.visible=!0,this.alert.showStopBet();var t=new egret.Timer(Settings.GameSettingUtils.timeSetting.alertWaitInterval,1);t.addEventListener(egret.TimerEvent.TIMER,this.removeAlert,this),t.start()},i.prototype.removeAlert=function(){this.contains(this.alert)&&(this.alert.visible=!1)},i.prototype.drawConnectErrorView=function(){this.connectErrorView=new t.PlayTable.ConnectErrorView,this.addChild(this.connectErrorView),this.connectErrorView.visible=!1,this.setChildIndex(this.connectErrorView,255)},i.prototype.showReConnect=function(){this.connectErrorView.visible=!0},i.prototype.hideReConnect=function(){this.connectErrorView&&(this.connectErrorView.visible=!1)},i.prototype.stopPutBet=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.putBet,this),this.betCoinContainer.betNum=this.lastBetNum},i.prototype.registEvents=function(){var e=this;this.helpBtn.touchEnabled=!0,this.helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("玩法说明"),e.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.putBet,e),e.canPutBet=!1,t.GameSceneManger.pushScene(t.HelpScene,Settings.GameSettingUtils.helpSetting,Settings.GameSettingUtils.gameSetting.globalWidth)},this),this.trendBtn.touchEnabled=!0,this.trendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("走势"),e.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.putBet,e),e.canPutBet=!1,t.GameSceneManger.pushScene(t.TrendScene,Settings.GameSettingUtils.trendSetting,Settings.GameSettingUtils.gameSetting.globalWidth)},this),this.recordBtn.touchEnabled=!0,this.recordBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("参与记录"),e.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.putBet,e),e.canPutBet=!1,t.GameSceneManger.pushScene(t.HistroyScene,Settings.GameSettingUtils.historySetting,Settings.GameSettingUtils.gameSetting.globalWidth)
},this)},i}(t.BaseScene);t.PlayTableScene=e,__reflect(e.prototype,"GameScenes.PlayTableScene")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.scrollCount=0,n.presenter=new t.HistoryPresenter(n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.loading=!1,n.currentTop=33,n.scrollTimer=new egret.Timer(30,0),n.scrollTimer.addEventListener(egret.TimerEvent.TIMER,n.autoScroll,n),n}return __extends(i,e),i.prototype.onAddToStage=function(t){this.initStyle(),this.presenter.getHistoryRecord(),this.drawContent(),this.drawRowBgView()},i.prototype.drawContent=function(){this.scrollView=new egret.ScrollView,this.addFixedChild(this.scrollView),this.scrollView.y=265*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,this.scrollView.x=56*Settings.GameSettingUtils.globalScale,this.scrollView.width=671,this.scrollView.horizontalScrollPolicy="off",this.scrollView.verticalScrollPolicy="on",this.scrollView.height=799},i.prototype.drawRowBgView=function(){this.rowBgView=new egret.DisplayObjectContainer,this.addChild(this.rowBgView),this.scrollView.setContent(this.rowBgView),this.loadingText=new egret.TextField,this.loadingText.text="正在加载数据...",this.loadingText.width=Settings.GameSettingUtils.gameSetting.globalWidth,this.loadingText.textAlign=egret.HorizontalAlign.CENTER,this.loadingText.textColor=6710886,this.orgLoadtingTextTop=1079+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,this.loadingText.y=1064+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,this.addFixedChild(this.loadingText),this.setChildIndex(this.loadingText,-1),this.scrollView.addEventListener(egret.Event.COMPLETE,this.onComplete,this)},i.prototype.onComplete=function(t){var e=t.currentTarget;if(this.offsetY=e.getMaxScrollTop(),e.scrollTop>=e.getMaxScrollTop()){if(this.loading)return;this.loading=!0,this.onLoadMore()}},i.prototype.onLoadMore=function(){this.loadingText.visible=!0,egret.Tween.get(this.loadingText).to({y:this.orgLoadtingTextTop*Settings.GameSettingUtils.globalScale},0,egret.Ease.sineIn),this.presenter.getMoreHistoryRecord(this.lastScheduleId),this.scrollView.touchEnabled=!1},i.prototype.setHistoryRowData=function(e){var i=this;if(this.scrollView.touchEnabled=!0,e&&e.length>0){for(var n=0;n<e.length;n++){var s=new t.HistoryRowScene;this.rowBgView.addChild(s),s.x=0,s.y=this.currentTop;var o=e[n];s.setHistoryData(o);var a=e[e.length-1];this.lastScheduleId=a.ScheduleId,this.currentTop+=s.height+14}this.loading=!1,egret.Tween.get(this.loadingText).wait(300).to({y:1114*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2},500,egret.Ease.sineIn).call(function(){i.loadingText.visible=!1}),this.presenter.historyData.length>10&&(this.scrollTimer.start(),this.scrollCount=0)}else this.loading=!1,this.loadingText.text="没有更多了哦~",egret.Tween.get(this.loadingText).wait(300).to({y:1114*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2},500,egret.Ease.sineIn).call(function(){i.loadingText.visible=!1})},i.prototype.autoScroll=function(){this.scrollCount>30&&this.scrollTimer.stop(),this.scrollView.scrollTop+=2,this.scrollCount++},i}(t.OtherScene);t.HistroyScene=e,__reflect(e.prototype,"GameScenes.HistroyScene")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n.presenter=new t.TrendPresenter(n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(i,e),i.prototype.onAddToStage=function(t){this.initStyle(),this.presenter.getTrend(),this.drawHeader(),this.drawContent()},i.prototype.drawHeader=function(){var t=new egret.TextField;this.addFixedChild(t),t.size=this.setting.header.textSize,t.textColor=this.setting.header.textColor,t.text=this.setting.header.title,t.x=this.setting.header.left*Settings.GameSettingUtils.globalScale,t.y=this.setting.header.top*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,t.fontFamily=this.setting.header.font;var e=new egret.TextField;this.addFixedChild(e),e.size=this.setting.header.textSize,e.textColor=this.setting.header.textColor,e.text=this.setting.header.text1,e.x=this.setting.header.text1X*Settings.GameSettingUtils.globalScale,e.y=(this.setting.header.top+2)*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,e.fontFamily=this.setting.header.font;var i=CommonUtils.BitmapUtils.createBitmapByName(this.setting.header.winIcon);this.addFixedChild(i),i.x=this.setting.header.winIconX*Settings.GameSettingUtils.globalScale,i.y=this.setting.header.iconTop*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2;var n=new egret.TextField;this.addFixedChild(n),n.size=this.setting.header.textSize,n.textColor=this.setting.header.textColor,n.text=this.setting.header.text2,n.x=e.x+(e.width+this.setting.header.padding1+this.setting.header.padding2+i.width)*Settings.GameSettingUtils.globalScale,n.y=(this.setting.header.top+2)*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,n.fontFamily=this.setting.header.font;var s=CommonUtils.BitmapUtils.createBitmapByName(this.setting.header.tieIcon);this.addFixedChild(s),s.x=n.x+(n.width+this.setting.header.padding1)*Settings.GameSettingUtils.globalScale,s.y=this.setting.header.iconTop*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2;var o=new egret.TextField;this.addFixedChild(o),o.size=this.setting.header.textSize,o.textColor=this.setting.header.textColor,o.text=this.setting.header.text3,o.x=n.x+(n.width+this.setting.header.padding1+this.setting.header.padding2+s.width)*Settings.GameSettingUtils.globalScale,o.y=(this.setting.header.top+2)*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,o.fontFamily=this.setting.header.font;var a=CommonUtils.BitmapUtils.createBitmapByName(this.setting.header.loseIcon);this.addFixedChild(a),a.x=o.x+(o.width+this.setting.header.padding1)*Settings.GameSettingUtils.globalScale,a.y=this.setting.header.iconTop*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2},i.prototype.setTrendRowData=function(e){for(var i=0;5>i;i++){var n=new t.TrendRowScene;this.addFixedChild(n),n.x=62*Settings.GameSettingUtils.globalScale,n.y=(332+(n.height+4)*i)*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2;var s=e[i];n.setTrendRow(s),console.log()}},i.prototype.drawContent=function(){var t=new egret.ScrollView;this.addFixedChild(t),t.y=333*Settings.GameSettingUtils.globalScale+(this.stage.stageHeight-Settings.GameSettingUtils.gameSetting.globalHeight)/2,t.x=87*Settings.GameSettingUtils.globalScale,t.width=603,t.horizontalScrollPolicy="off",t.verticalScrollPolicy="on",t.height=695},i}(t.OtherScene);t.TrendScene=e,__reflect(e.prototype,"GameScenes.TrendScene")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(){function t(){}return t.prototype.setUserToken=function(t){this.userToken=t},t.prototype.getUserToken=function(){return this.userToken},t}();t.BasePresenter=e,__reflect(e.prototype,"GameScenes.BasePresenter")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(i,e),i.prototype.onAddToStage=function(){this.drawBg(),this.drawBgView(),this.drawTitle(),this.drawAlertText(),this.drawBtn()},i.prototype.drawBg=function(){var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,Settings.GameSettingUtils.gameSetting.globalWidth,Settings.GameSettingUtils.gameSetting.globalHeight),t.graphics.endFill(),this.addChild(t)},i.prototype.drawBgView=function(){this.bitmap=CommonUtils.BitmapUtils.createBitmapByName("网络错误框_png"),this.addChild(this.bitmap),this.bitmap.x=(Settings.GameSettingUtils.gameSetting.globalWidth-this.bitmap.width)/2,this.bitmap.y=(Settings.GameSettingUtils.gameSetting.globalHeight-this.bitmap.height)/2},i.prototype.drawTitle=function(){var t=new egret.TextField;t.textColor=16777215,t.size=35,t.width=Settings.GameSettingUtils.gameSetting.globalWidth,t.textAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.text="提示",this.addChild(t),t.y=503},i.prototype.drawAlertText=function(){var t=new egret.TextField;this.addChild(t),t.size=24,t.textColor=11038013,t.textAlign=egret.HorizontalAlign.LEFT,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.fontFamily="苹方",t.text="断线重连中,请耐心等待...",t.y=619,t.x=(Settings.GameSettingUtils.gameSetting.globalWidth-t.width)/2},i.prototype.drawBtn=function(){this.exitBtn=CommonUtils.BitmapUtils.createBitmapByName("按钮_png"),this.exitBtn.touchEnabled=!0,this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeGame,this),this.addChild(this.exitBtn),this.exitBtn.y=715,this.exitBtn.x=(Settings.GameSettingUtils.gameSetting.globalWidth-this.exitBtn.width)/2;var t=new egret.TextField;this.addChild(t),t.size=22,t.textColor=16777215,t.textAlign=egret.HorizontalAlign.LEFT,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.fontFamily="苹方",t.text="退出游戏",t.y=this.exitBtn.y+(this.exitBtn.height-t.height)/2,t.x=this.exitBtn.x+(this.exitBtn.width-t.width)/2},i.prototype.closeGame=function(){t.GameSceneManger.destoryScene(this),NativeClose(),ocClick(),Server.Connector.getGameClient().close()},i}(egret.DisplayObjectContainer);e.ConnectErrorView=i,__reflect(i.prototype,"GameScenes.PlayTable.ConnectErrorView")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameScenes;!function(t){var e=function(){function e(){}return e.setRootStage=function(t){this.rootStage=t},e.pushScene=function(t,i,n,s){if(e.SupportScene.indexOf(t)<0)throw new Error("UnSupportScene");if(null==this.rootStage)throw new Error("rootStage hasn't setted");var o=new t(i);return o.touchEnabled=!0,o.setUserToken(CommonUtils.AccountUtils.getAccountToken()),o.extraData=s,this.rootStage.addChild(o),o},e.destoryScene=function(t){this.removeObject(t,this.rootStage);var e=this.rootStage.$children[1];e.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,e.putBet,e),e.canPutBet=!0},e.removeObject=function(t,e){var i=this;if(null!=t&&!(e.$children.indexOf(t)<0)){if(!(t instanceof egret.DisplayObjectContainer))return void e.removeChild(t);null!=t.$children&&t.$children.length>0&&t.$children.forEach(function(e){i.removeObject(e,t)}),e.removeChild(t)}},e.SupportScene=[t.PlayTableScene,t.HelpScene,t.HistroyScene,t.TrendScene],e}();t.GameSceneManger=e,__reflect(e.prototype,"GameScenes.GameSceneManger")}(GameScenes||(GameScenes={}));var ConnectingUI=function(t){function e(){var e=t.call(this)||this;return e.paddingToBottom=594,e.once(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.bg=CommonUtils.BitmapUtils.createBitmapByName("系统弹出框_png"),this.textField=new egret.TextField,this.textField.size=30,this.textField.bold=!0,this.addChild(this.bg),this.addChild(this.textField),this.bg.x=(this.stage.stageWidth-this.bg.width)/2},e.prototype.setConnectText=function(t){this.textField.text=t,this.textField.x=(this.stage.stageWidth-this.textField.width)/2,this.textField.y=this.bg.y+(this.bg.height-this.textField.height)/2},e}(egret.DisplayObjectContainer);__reflect(ConnectingUI.prototype,"ConnectingUI");var GameScenes;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onDestroy=function(){this.onDestroy()},e.prototype.onAddToStage=function(){this.bg=new egret.Shape,this.addChild(this.bg),this.bg.width=627,this.bg.height=141,this.bg.graphics.beginFill(16775395),this.bg.graphics.drawRoundRect(0,0,640,348,20,20),this.bg.graphics.endFill(),this.scheduleTF=new egret.TextField,this.addChild(this.scheduleTF),this.scheduleTF.textColor=11038013,this.scheduleTF.size=24,this.scheduleTF.textAlign=egret.HorizontalAlign.CENTER,this.scheduleTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.scheduleTF.fontFamily="PingFang-SC-Medium",this.scheduleTF.x=20,this.scheduleTF.y=28,this.gameStatusTF=new egret.TextField,this.addChild(this.gameStatusTF),this.gameStatusTF.textColor=11038013,this.gameStatusTF.size=24,this.gameStatusTF.textAlign=egret.HorizontalAlign.CENTER,this.gameStatusTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.gameStatusTF.fontFamily="PingFang-SC-Medium",this.gameStatusTF.y=28;var t=new egret.Shape;this.addChild(t),t.graphics.beginFill(16112839),t.graphics.drawRect(0,0,612,2),t.graphics.endFill(),t.x=11,t.y=71;var e=new egret.TextField;this.addChild(e),e.textColor=11038013,e.size=23,e.textAlign=egret.HorizontalAlign.CENTER,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.fontFamily="PingFang-SC-Medium",e.text="庄:",e.x=19,e.y=110;var i=new egret.TextField;this.addChild(i),i.textColor=11038013,i.size=23,i.textAlign=egret.HorizontalAlign.CENTER,i.verticalAlign=egret.VerticalAlign.MIDDLE,i.fontFamily="PingFang-SC-Medium",i.text="青龙:",i.x=371,i.y=110;var n=new egret.TextField;this.addChild(n),n.textColor=11038013,n.size=23,n.textAlign=egret.HorizontalAlign.CENTER,n.verticalAlign=egret.VerticalAlign.MIDDLE,n.fontFamily="PingFang-SC-Medium",n.text="玄武:",n.x=19,n.y=155;var s=new egret.TextField;this.addChild(s),s.textColor=11038013,s.size=23,s.textAlign=egret.HorizontalAlign.CENTER,s.verticalAlign=egret.VerticalAlign.MIDDLE,s.fontFamily="PingFang-SC-Medium",s.text="白虎:",s.x=371,s.y=155;var o=new egret.TextField;this.addChild(o),o.textColor=11038013,o.size=23,o.textAlign=egret.HorizontalAlign.CENTER,o.verticalAlign=egret.VerticalAlign.MIDDLE,o.fontFamily="PingFang-SC-Medium",o.text="闲:",o.x=19,o.y=199;var a=new egret.TextField;this.addChild(a),a.textColor=11038013,a.size=23,a.textAlign=egret.HorizontalAlign.CENTER,a.verticalAlign=egret.VerticalAlign.MIDDLE,a.fontFamily="PingFang-SC-Medium",a.text="桥:",a.x=371,a.y=199;var r=new egret.Shape;this.addChild(r),r.graphics.beginFill(16112839),r.graphics.drawRect(0,0,612,2),r.graphics.endFill(),r.x=11,r.y=263,this.timeTF=new egret.TextField,this.addChild(this.timeTF),this.timeTF.textColor=11038013,this.timeTF.size=23,this.timeTF.textAlign=egret.HorizontalAlign.CENTER,this.timeTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.timeTF.fontFamily="PingFang-SC-Medium",this.timeTF.x=20,this.timeTF.y=289,this.beanTF=new egret.TextField,this.addChild(this.beanTF),this.beanTF.size=23,this.beanTF.textAlign=egret.HorizontalAlign.CENTER,this.beanTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.beanTF.fontFamily="PingFang-SC-Medium",this.beanTF.y=289},e.prototype.setHistoryData=function(t){this.scheduleTF.text="第"+t.ScheduleNumber+"期",t.State<3?this.gameStatusTF.text="等待开牌":this.gameStatusTF.text="已结算",this.gameStatusTF.x=this.bg.width-27-this.gameStatusTF.width,3==t.State?this.timeTF.text="开奖时间:"+t.BetTime:this.timeTF.text="开奖时间:?";for(var e=0;6>e;e++){var i=t.Option[e];if(e>0&&4>e&&1==i.WinStatus){var n=CommonUtils.BitmapUtils.createBitmapByName("光_png");this.addChild(n),n.x=353*Math.floor(e%2),n.y=105+47*Math.floor(e/2),this.setChildIndex(n,this.numChildren-12-e)}if(4>e){if(3==t.State){var s=CommonUtils.BitmapUtils.createBitmapByName(i.CardLevel+"-2_png");if(this.addChild(s),s.x=70+375*Math.floor(e%2),s.y=103+46*Math.floor(e/2),2==e){a=t.Option[5];var o=new egret.TextField;switch(this.addChild(o),o.textColor=11038013,o.size=23,o.textAlign=egret.HorizontalAlign.CENTER,o.verticalAlign=egret.VerticalAlign.MIDDLE,o.fontFamily="PingFang-SC-Medium",o.x=96,o.y=200,a.WinStatus){case-1:o.text="负";break;case 0:o.text="平";break;case 1:o.text="胜"}}}}else{var o=new egret.TextField;this.addChild(o),o.textColor=11038013,o.size=23,o.textAlign=egret.HorizontalAlign.CENTER,o.verticalAlign=egret.VerticalAlign.MIDDLE,o.fontFamily="PingFang-SC-Medium",o.text="";var a;if(5==e&&(a=t.Option[4]),3==t.State)switch(a.WinStatus){case-1:o.text="负";break;case 0:o.text="平";break;case 1:o.text="胜"}o.x=96+378*Math.floor(e/5),o.y=200}var r=new egret.TextField;this.addChild(r),r.textColor=16753152,r.size=26,r.textAlign=egret.HorizontalAlign.CENTER,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.fontFamily="PingFang-SC-Medium",r.text=i.TotalBetNumber.toString();var a;4==e?(a=t.Option[2],r.text=a.TotalBetNumber.toString()):2==e?(a=t.Option[5],r.text=a.TotalBetNumber.toString()):5==e&&(a=t.Option[4],r.text=a.TotalBetNumber.toString()),r.x=158+375*Math.floor(e%2),r.y=112+46*Math.floor(e/3),(2==e||5==e)&&(r.y=200)}3==t.State?t.WinNumber>=0?(this.beanTF.textColor=16753152,this.beanTF.text="+"+t.WinNumber.toString()):(this.beanTF.textColor=46472,this.beanTF.text=t.WinNumber.toString()):this.beanTF.text="",this.beanTF.x=this.bg.width-27-this.beanTF.width;for(var e=0;6>e;e++)if(3!=t.State){var h=new egret.TextField;this.addChild(h),h.textColor=11038013,h.size=23,h.textAlign=egret.HorizontalAlign.CENTER,h.verticalAlign=egret.VerticalAlign.MIDDLE,h.fontFamily="PingFang-SC-Medium",h.x=96+378*Math.floor(e%2),h.y=112+46*Math.floor(e/3),h.text="?",(2==e||5==e)&&(h.y=200)}},e}(egret.DisplayObjectContainer);t.HistoryRowScene=e,__reflect(e.prototype,"GameScenes.HistoryRowScene")}(GameScenes||(GameScenes={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.barPadding=18,e.once(egret.Event.ADDED_TO_STAGE,function(t){e.createLoadingTextField(),e.createLoadingBar()},e),e}return __extends(e,t),e.prototype.createLoadingTextField=function(){this.loadTF=new egret.TextField,this.loadTF.size=28,this.loadTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.loadTF.textAlign=egret.HorizontalAlign.CENTER,this.loadTF.width=this.stage.stageWidth,this.loadTF.text="正在加载游戏资源...",this.loadTF.filters=[new egret.DropShadowFilter(2,45,2185068,1,2,2)],this.addChild(this.loadTF)},e.prototype.createLoadingBar=function(){BitmapHelper.loadBitmapFromUrl("resource/assets/images/进度条d.png",this.initLoadProgressBg,this)},e.prototype.initLoadProgressBg=function(t){this.loadProgressBg=t,this.addChild(this.loadProgressBg),this.loadProgressBg.y=this.loadTF.y+this.loadTF.height+this.barPadding,this.loadProgressBg.x=(this.stage.stageWidth-this.loadProgressBg.width)/2,BitmapHelper.loadBitmapFromUrl("resource/assets/images/进度条.png",this.initLoadProgressView,this)},e.prototype.initLoadProgressView=function(t){this.loadProgressView=t,this.addChild(this.loadProgressView),this.progressWidth=this.loadProgressView.width,this.loadProgressView.y=this.loadProgressBg.y+(this.loadProgressBg.height-this.loadProgressView.height)/2,this.loadProgressView.x=(this.stage.stageWidth-this.loadProgressView.width)/2,this.loadProgressView.scale9Grid=new egret.Rectangle(12,12,this.loadProgressView.width-24,this.loadProgressView.height-24),this.loadProgressView.width=0},e.prototype.onProgress=function(t,e){this.loadProgressView&&(this.loadProgressView.width=t/e*this.progressWidth)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingViewTop=787,e.serverConnectViewTop=644,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),GameScenes.GameSceneManger.setRootStage(this),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGrouploadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemloadError,this),this.loadingView=new LoadingUI,this.addChild(this.loadingView),this.loadingView.width=this.loadingView.width,this.loadingView.y=this.loadingViewTop,RES.loadGroup("preload")},e.prototype.onGroupComplete=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGrouploadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemloadError,this),this.serverConnectView=new ConnectingUI,this.stage.addChild(this.serverConnectView),this.serverConnectView.y=this.serverConnectViewTop,Settings.GameSettingUtils.gameSetting=RES.getRes("play_table_setting_json"),Settings.GameSettingUtils.helpSetting=RES.getRes("help_setting_json"),Settings.GameSettingUtils.historySetting=RES.getRes("history_setting_json"),Settings.GameSettingUtils.trendSetting=RES.getRes("trend_setting_json"),Settings.GameSettingUtils.timeSetting=RES.getRes("time_setting_json"),Server.Connector&&Server.Connector.getGameClient()&&Server.Connector.getGameClient().close(),Server.Connector.initConnector(RES.getRes("server_gate_setting_json")),Server.Connector.startConnectToGateServer(this))},e.prototype.onGrouploadError=function(t){console.warn("Group:"+t.groupName+" has failed to load")},e.prototype.onItemloadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onGroupProgress=function(t){"preload"==t.groupName&&this.loadingView.onProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.onGateServerConnectFailed=function(t){this.serverConnectView.setConnectText(t)},e.prototype.onBeforeGateServerConnected=function(){this.serverConnectView.setConnectText("加载服务器数据")},e.prototype.onGateServerConnected=function(){this.serverConnectView.setConnectText("加载服务器数据")},e.prototype.onGetGameServerSuccess=function(){this.serverConnectView.setConnectText("加载服务器数据")},e.prototype.onGetGameServerFailed=function(t){this.serverConnectView.setConnectText(t)},e.prototype.onConnectToGameServerFailed=function(t){this.serverConnectView.setConnectText(t)},e.prototype.onGameServerConnected=function(){this.serverConnectView.setConnectText("加载服务器数据"),this.stage.removeChild(this.serverConnectView),GameScenes.GameSceneManger.pushScene(GameScenes.PlayTableScene,Settings.GameSettingUtils.gameSetting,this.stage.stageWidth)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}var a=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var CommonUtils;!function(t){var e=function(){function t(){}return t.getAccountToken=function(){return this.accountToken||(this.accountToken=document.getElementById("userToken").attributes.value.value),this.accountToken},t}();t.AccountUtils=e,__reflect(e.prototype,"CommonUtils.AccountUtils")}(CommonUtils||(CommonUtils={}));var GameScenes;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(){var t=new egret.Shape;this.addChild(t),t.width=627,t.height=141,t.graphics.beginFill(16775395),t.graphics.drawRoundRect(0,0,627,141,20,20),t.graphics.endFill(),this.winRateBg=new egret.Shape,this.addChild(this.winRateBg),this.winRateBg.width=96,this.winRateBg.height=41,this.winRateBg.graphics.beginFill(12427905),this.winRateBg.graphics.drawRoundRect(0,0,96,41,12),this.winRateBg.graphics.endFill(),this.winRateBg.x=109,this.winRateBg.y=43,this.winRateBitmap=CommonUtils.BitmapUtils.createBitmapByName("胜率进度条_png"),this.winRateBitmap.scale9Grid=new egret.Rectangle(15,15,this.winRateBitmap.width-30,this.winRateBitmap.height-30),this.addChild(this.winRateBitmap),this.winRateBitmap.x=113,this.winRateBitmap.y=46,this.winRateTF=new egret.TextField,this.addChild(this.winRateTF),this.winRateTF.textColor=16777215,this.winRateTF.size=28,this.winRateTF.textAlign=egret.HorizontalAlign.CENTER,this.winRateTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.winRateTF.fontFamily="PingFang-SC-Medium",this.winRateTF.text="",this.winRateTF.x=this.winRateBg.x+(this.winRateBg.width-this.winRateTF.width)/2,this.winRateTF.y=this.winRateBg.y+(this.winRateBg.height-this.winRateTF.height)/2,this.resultBg=new egret.Shape,this.addChild(this.resultBg),this.resultBg.width=378,this.resultBg.height=43,this.resultBg.graphics.beginFill(16051150),this.resultBg.graphics.drawRoundRect(0,0,378,43,12,12),this.resultBg.graphics.endFill(),this.resultBg.x=222,this.resultBg.y=46},e.prototype.setTrendRow=function(t){var e;switch(t.OptionId){case 1:e=CommonUtils.BitmapUtils.createBitmapByName("青龙小图标_png"),this.addChild(e),e.x=31,e.y=36;break;case 2:e=CommonUtils.BitmapUtils.createBitmapByName("白虎小图标_png"),this.addChild(e),e.x=31,e.y=36;break;case 3:e=CommonUtils.BitmapUtils.createBitmapByName("玄武小图标_png"),this.addChild(e),e.x=31,e.y=36;break;case 4:e=CommonUtils.BitmapUtils.createBitmapByName("桥小图标_png"),this.addChild(e),e.x=31,e.y=36;break;case 5:e=CommonUtils.BitmapUtils.createBitmapByName("闲小图标_png"),this.addChild(e),e.x=31,e.y=36}this.winRateBitmap.width=this.winRateBitmap.width*t.WinRate/100,this.winRateTF.text=t.WinRate.toString()+"%",this.winRateTF.x=this.winRateBg.x+(this.winRateBg.width-this.winRateTF.width)/2,this.winRateTF.y=this.winRateBg.y+(this.winRateBg.height-this.winRateTF.height)/2;for(var i=0;10>i;i++)this.resultBitmap=CommonUtils.BitmapUtils.createBitmapByName(t.WinStatusResult[i]+"2_png"),this.addChild(this.resultBitmap),this.resultBitmap.x=this.resultBg.x+6+i*(13+this.resultBitmap.width),this.resultBitmap.y=57},e}(egret.DisplayObjectContainer);t.TrendRowScene=e,__reflect(e.prototype,"GameScenes.TrendRowScene")}(GameScenes||(GameScenes={}));var CommonUtils;!function(t){var e=function(){function t(){}return t.createBitmapFontByName=function(t){var e=RES.getRes(t);return e},t}();t.BitmapFontUtils=e,__reflect(e.prototype,"CommonUtils.BitmapFontUtils")}(CommonUtils||(CommonUtils={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.drawBg(),this.initFont()},e.prototype.drawBg=function(){this.cacheAsBitmap=!0,this.bg=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.bg),this.bg.x=this.setting.left,this.bg.y=(Settings.GameSettingUtils.gameSetting.globalHeight-this.bg.height)/2},e.prototype.initFont=function(){this.bitmapText=new egret.BitmapText,this.addChild(this.bitmapText),this.bitmapText.font=CommonUtils.BitmapFontUtils.createBitmapFontByName(this.setting.fontName),this.bitmapText.text="",this.bitmapText.x=(this.bg.width-this.bitmapText.width)/2,this.bitmapText.y=this.bg.y+(this.bg.height-this.bitmapText.height)/2,this.startBitmap=CommonUtils.BitmapUtils.createBitmapByName(this.setting.startIconName),this.addChild(this.startBitmap),this.startBitmap.visible=!1,this.stopBitmap=CommonUtils.BitmapUtils.createBitmapByName(this.setting.stopIconName),this.addChild(this.stopBitmap),this.stopBitmap.visible=!1},e.prototype.showBitmapTextContent=function(t,e){this.startBitmap.visible=!1,this.stopBitmap.visible=!1,this.bitmapText.text="",e?this.bitmapText.text=t+e.toString():this.bitmapText.text=t,this.bitmapText.x=(this.bg.width-this.bitmapText.width)/2,this.bitmapText.y=this.bg.y+(this.bg.height-this.bitmapText.height)/2},e.prototype.showStartBet=function(){this.startBitmap.visible=!0,this.stopBitmap.visible=!1,this.bitmapText.text="",this.startBitmap.x=(this.bg.width-this.startBitmap.width)/2,this.startBitmap.y=this.bg.y+(this.bg.height-this.startBitmap.height)/2},e.prototype.showStopBet=function(){this.startBitmap.visible=!1,this.stopBitmap.visible=!0,this.bitmapText.text="",this.stopBitmap.x=(this.bg.width-this.stopBitmap.width)/2,this.stopBitmap.y=this.bg.y+(this.bg.height-this.stopBitmap.height)/2},e}(egret.DisplayObjectContainer);t.Alert=e,__reflect(e.prototype,"GameScenes.PlayTable.Alert")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.betBitmapIndex=0,e.once(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.getCoinContainerSetting=function(){return this._coinContainerSetting||(this._coinContainerSetting=RES.getRes(this.configFile)),this._coinContainerSetting},e.prototype.loadCoins=function(){this.drawCoins(),this.registCoinEvents()},e.prototype.onAddToStage=function(t){this.drawBg()},e.prototype.registCoinEvents=function(){var t=this;this.coinUIList.forEach(function(e,i){e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(i){t.unactivateAllCoin(),e.activated=!0,t.resetCoinListStyle(!0)},t)})},e.prototype.checkBetNum=function(t,e,i){t*i>e+t?this.unTouchEable():t*i>e+t&&this.setBetCoinUnActivate(this.betBitmapIndex),t*i+100*i>e+t?this.unTouchEable():t*i+500*i>e-1+t?500==this.betNum&&(this.resetBet(0),this.betBitmapIndex=0,this.betNum=100):t*i+1e3*i>e+t?1e3==this.betNum&&(this.resetBet(1),this.betBitmapIndex=1,this.betNum=500):t*i+5e3*i>e+t&&5e3==this.betNum&&(this.resetBet(2),this.betNum=1e3,this.betBitmapIndex=2),t*i+5e3*i>e+t&&this.setBetCoinUnActivate(3),t*i+1e3*i>e+t&&this.setBetCoinUnActivate(2),t*i+500*i>e+t&&this.setBetCoinUnActivate(1),5e3*i>e+t&&this.setBetCoinUnActivate(3),1e3*i>e+t&&this.setBetCoinUnActivate(2),500*i>e+t&&this.setBetCoinUnActivate(1),100*i>e+t&&this.setBetCoinUnActivate(0)},e.prototype.drawBg=function(){var t=CommonUtils.BitmapUtils.createBitmapByName(e.getCoinContainerSetting().backgroundImage);t.x=(Settings.GameSettingUtils.gameSetting.globalWidth-t.width)/2,this.addChild(t)},e.prototype.drawCoins=function(){var t=this;this.coinUIList=[];var n=e.getCoinContainerSetting().normalWidth,s=e.getCoinContainerSetting().normalWidth*e.getCoinContainerSetting().coins.length,o=(Settings.GameSettingUtils.gameSetting.globalWidth-2*e.getCoinContainerSetting().padding-s)/(e.getCoinContainerSetting().coins.length+1),a=e.getCoinContainerSetting().padding;e.getCoinContainerSetting().coins.forEach(function(s,r){t.coinUIList[r]=new i(s,t),t.addChild(t.coinUIList[r]),a+=o+n/2,t.coinUIList[r].width=e.getCoinContainerSetting().normalWidth,t.coinUIList[r].height=e.getCoinContainerSetting().normalHeight,t.coinUIList[r].x=a,t.coinUIList[r].y=.7*t.coinUIList[r].height,a+=n/2
}),this.resetCoinListStyle(!1)},e.prototype.resetCoinListStyle=function(t){var i=this;this.coinUIList.forEach(function(n,s){var o=1;if(n.activated)switch(o=e.getCoinContainerSetting().activatedScale,s){case 0:i.betNum=100,i.betBitmapIndex=0;break;case 1:i.betNum=500,i.betBitmapIndex=1;break;case 2:i.betNum=1e3,i.betBitmapIndex=2;break;case 3:i.betNum=5e3,i.betBitmapIndex=3}t?n.scaleX==o?n.resetStyle():egret.Tween.get(n).to({scaleX:o+.1,scaleY:o+.1},130).to({scaleX:o,scaleY:o},20).call(function(){n.resetStyle()}):(n.scaleX=o,n.scaleY=o,n.resetStyle())})},e.prototype.unactivateAllCoin=function(){this.coinUIList.forEach(function(t,e){t.activated=!1})},e.prototype.unTouchEable=function(){this.coinUIList.forEach(function(t,e){t.activated=!1,t.touchEnabled=!1,t.canClick=!1,t.scaleX=t.scaleY=1,t.resetStyle()})},e.prototype.setBetCoinUnActivate=function(t){this.coinUIList.forEach(function(e,i){i==t&&(e.activated=!1,e.touchEnabled=!1,e.scaleX=e.scaleY=1,e.canClick=!1,e.resetStyle())})},e.prototype.resetBet=function(t){var e=this;this.coinUIList.forEach(function(i,n){i.canClick=!0,i.touchEnabled=!0,i.activated=!1,i.resetStyle(),t==n&&(i.activated=!0,e.resetCoinListStyle(!0))})},e.configFile="coinContainerSetting_json",e}(egret.Sprite);t.BetCoinContainerUI=e,__reflect(e.prototype,"GameScenes.PlayTable.BetCoinContainerUI");var i=function(t){function e(e,i){var n=t.call(this)||this;return n.coin=e,n.activated=!1,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.resetStyle=function(t){this.canClick?this.activated?(this.normalImage.visible=!1,this.activatedImage.visible=!0,this.unActivatedImage.visible=!1):(this.normalImage.visible=!0,this.activatedImage.visible=!1,this.unActivatedImage.visible=!1):(this.normalImage.visible=!1,this.activatedImage.visible=!1,this.unActivatedImage.visible=!0)},e.prototype.onAddToStage=function(t){this.drawCoin()},e.prototype.drawCoin=function(){this.normalImage=CommonUtils.BitmapUtils.createBitmapByName(this.coin.coinIcon),this.normalImage.anchorOffsetX=this.normalImage.width/2,this.normalImage.anchorOffsetY=this.normalImage.height,this.addChild(this.normalImage),this.activatedImage=CommonUtils.BitmapUtils.createBitmapByName(this.coin.activatedIcon),this.activatedImage.anchorOffsetX=this.activatedImage.width/2,this.activatedImage.anchorOffsetY=this.activatedImage.height,this.addChild(this.activatedImage),this.unActivatedImage=CommonUtils.BitmapUtils.createBitmapByName(this.coin.unActivatedIcon),this.unActivatedImage.anchorOffsetX=this.unActivatedImage.width/2,this.unActivatedImage.anchorOffsetY=this.unActivatedImage.height,this.addChild(this.unActivatedImage)},e}(egret.Sprite);__reflect(i.prototype,"CoinUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.drawBitmap(),this.drawBg(),this.setChildIndex(this.bitmap,this.numChildren-1),this.drawBetNumTF()},e.prototype.drawBitmap=function(){this.cacheAsBitmap=!0,this.bitmap=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.bitmap),this.bitmap.x=this.setting.left,this.bitmap.y=this.setting.top},e.prototype.drawBg=function(){this.bg=new egret.Shape,this.addChild(this.bg),this.bg.graphics.beginFill(this.setting.textBgColor),this.bg.graphics.lineStyle(1,this.setting.borderColor),this.bg.graphics.drawRoundRect(0,0,this.setting.width,this.setting.height,2*this.setting.radius),this.bg.graphics.endFill(),this.bg.x=this.bitmap.x+this.bitmap.width-this.setting.padding,this.bg.y=this.bitmap.y+this.setting.padding},e.prototype.drawBetNumTF=function(){this.betNumTF=new egret.TextField,this.addChild(this.betNumTF),this.betNumTF.size=this.setting.textSize,this.betNumTF.textColor=this.setting.textColor,this.betNumTF.textAlign=egret.HorizontalAlign.CENTER,this.betNumTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.betNumTF.x=this.bg.x+(this.bg.width-this.betNumTF.width)/2,this.betNumTF.y=this.bg.y+(this.bg.height-this.betNumTF.height)/2},e.prototype.setTotleBetNum=function(t){t.toString().length>=7?this.betNumTF.text=CommonUtils.NumberUtils.shortNumber(t):this.betNumTF.text=CommonUtils.NumberUtils.formatNumber(t),this.betNumTF.x=this.bg.x+(this.bg.width-this.betNumTF.width)/2,this.betNumTF.y=this.bg.y+(this.bg.height-this.betNumTF.height)/2},e}(egret.DisplayObjectContainer);t.BetNumUI=e,__reflect(e.prototype,"GameScenes.PlayTable.BetNumUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e,i){var n=t.call(this)||this;return n.playerName=e,n.setting=i,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){var t=new egret.TextField;this.addChild(t),t.size=this.setting.textSize,t.textColor=this.setting.textColor,t.textAlign=egret.HorizontalAlign.LEFT,t.text=this.playerName,t.x=this.setting.playerTFLeftPadding,t.width=this.setting.playerTFWidth,this.betNumTF=new egret.TextField,this.addChild(this.betNumTF),this.betNumTF.size=this.setting.textSize,this.betNumTF.textColor=this.setting.numberColor,this.betNumTF.textAlign=egret.HorizontalAlign.LEFT,this.betNumTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.betNumTF.text="0",this.betNumTF.x=this.setting.playerTFLeftPadding+this.setting.playerTFWidth+this.setting.betNumTFLeftPadding},e.prototype.setBetNum=function(t){t.toString().length>=7?this.betNumTF.text=CommonUtils.NumberUtils.shortNumber(t):this.betNumTF.text=CommonUtils.NumberUtils.formatNumber(t)},e}(egret.DisplayObjectContainer);t.BetStatisticsPlayerUI=e,__reflect(e.prototype,"GameScenes.PlayTable.BetStatisticsPlayerUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.setting=t,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(i,e),i.prototype.onAddToStage=function(){this.drawBg(),this.drawTitle(),this.drawPlayer1TF(),this.drawPlayer2TF(),this.drawPlayer3TF(),this.drawPlayer4TF(),this.drawPlayer5TF()},i.prototype.drawBg=function(){this.cacheAsBitmap=!0,this.bg=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.bg),this.bg.x=this.setting.left,this.bg.y=this.setting.top},i.prototype.drawTitle=function(){this.title=new egret.TextField,this.addChild(this.title),this.title.size=this.setting.textSize,this.title.textColor=this.setting.textColor,this.title.textAlign=egret.HorizontalAlign.CENTER,this.title.verticalAlign=egret.VerticalAlign.MIDDLE,this.title.text=this.setting.title,this.title.x=this.bg.x+(this.bg.width-this.title.width)/2,this.title.y=this.bg.y+this.setting.titlePaddingToTop},i.prototype.drawPlayer1TF=function(){this.player1TF=new t.PlayTable.BetStatisticsPlayerUI(this.setting.play1Name,this.setting),this.addChild(this.player1TF),this.player1TF.y=this.setting.play1NameTop},i.prototype.drawPlayer2TF=function(){this.player2TF=new t.PlayTable.BetStatisticsPlayerUI(this.setting.play2Name,this.setting),this.addChild(this.player2TF),this.player2TF.y=this.setting.play1NameTop+this.setting.betNumTFTopPadding},i.prototype.drawPlayer3TF=function(){this.player3TF=new t.PlayTable.BetStatisticsPlayerUI(this.setting.play3Name,this.setting),this.addChild(this.player3TF),this.player3TF.y=this.setting.play1NameTop+2*this.setting.betNumTFTopPadding},i.prototype.drawPlayer4TF=function(){this.player4TF=new t.PlayTable.BetStatisticsPlayerUI(this.setting.play4Name,this.setting),this.addChild(this.player4TF),this.player4TF.y=this.setting.play1NameTop+3*this.setting.betNumTFTopPadding},i.prototype.drawPlayer5TF=function(){this.player5TF=new t.PlayTable.BetStatisticsPlayerUI(this.setting.play5Name,this.setting),this.addChild(this.player5TF),this.player5TF.y=this.setting.play1NameTop+4*this.setting.betNumTFTopPadding},i}(egret.DisplayObjectContainer);e.BetStatisticsUI=i,__reflect(i.prototype,"GameScenes.PlayTable.BetStatisticsUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var BitmapHelper=function(){function t(){}return t.loadBitmapFromUrl=function(t,e,i){var n=new egret.ImageLoader;n.once(egret.Event.COMPLETE,function(t){var n=t.currentTarget.data,s=new egret.Texture;s.bitmapData=n;var o=new egret.Bitmap(s);e&&e.call(i,o)},i),n.load(t)},t}();__reflect(BitmapHelper.prototype,"BitmapHelper");var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.drawClock(),this.drawBg(),this.setChildIndex(this.clock,this.numChildren-1),this.drawTimerTF(),this.countNum=new egret.Bitmap,this.countNum.y=517,this.addChild(this.countNum),this.countNum.visible=!1,this.countdownRes=[];for(var t=1;5>=t;t++)this.countdownRes[t]=RES.getRes("倒计时"+t.toString()+"_png");this.cacheAsBitmap=!0},e.prototype.drawClock=function(){this.clock=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.clock),this.clock.x=this.setting.left,this.clock.y=this.setting.top},e.prototype.drawBg=function(){this.bg=CommonUtils.BitmapUtils.createBitmapByName(this.setting.bgIconName),this.addChild(this.bg),this.bg.x=21,this.bg.y=this.setting.top+(this.clock.height-this.bg.height)/2},e.prototype.drawTimerTF=function(){this.timerTF=new egret.TextField,this.addChild(this.timerTF),this.timerTF.size=this.setting.textSize,this.timerTF.textColor=this.setting.textColor,this.timerTF.textAlign=egret.HorizontalAlign.CENTER,this.timerTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.timerTF.text=" ",this.timerTF.fontFamily=this.setting.font,this.timerTF.x=this.bg.x+(this.bg.width-this.timerTF.width)/2,this.timerTF.y=this.bg.y+(this.bg.height-this.timerTF.height)/2},e.prototype.showCountdownSeconds=function(t,e){e==Model.RoundState.Unstarted?this.timerTF.text="开始倒计时 "+t.toString()+"s":e==Model.RoundState.Started?this.timerTF.text="下注倒计时 "+t.toString()+"s":e==Model.RoundState.Frozen?this.timerTF.text="封盘中...":e==Model.RoundState.Open?this.timerTF.text="正在开牌":e==Model.RoundState.Settled&&(this.timerTF.text="结算中..."),t&&5>=t?this.timerTF.textColor=this.setting.noticeColor:this.timerTF.textColor=this.setting.textColor,this.timerTF.x=this.bg.x+(this.bg.width-this.timerTF.width)/2+10,this.timerTF.y=this.bg.y+(this.bg.height-this.timerTF.height)/2,this.showCountDown(t)},e.prototype.showCountDown=function(t){if(t>5||1>t)return void(this.countNum.visible=!1);this.countNum.visible=!0;var e=this.countdownRes[t];console.log(e),this.countNum.texture=e,console.log(this.countNum),this.countNum.x=(750-this.countNum.width)/2},e}(egret.DisplayObjectContainer);t.CountDownTimer=e,__reflect(e.prototype,"GameScenes.PlayTable.CountDownTimer")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.cacheAsBitmap=!0,this.icon=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.icon),this.icon.x=this.setting.left,this.icon.y=this.setting.top},e}(egret.DisplayObjectContainer);t.IconUI=e,__reflect(e.prototype,"GameScenes.PlayTable.IconUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.cacheAsBitmap=!0,this.icon=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.icon),this.icon.x=this.setting.left,this.icon.y=this.setting.top,this.txt=new egret.TextField,this.addChild(this.txt),this.txt.textAlign=egret.HorizontalAlign.CENTER,this.txt.verticalAlign=egret.VerticalAlign.MIDDLE,this.txt.size=this.setting.textSize,this.txt.fontFamily=this.setting.font,this.txt.textColor=this.setting.textColor,this.txt.text="在线\n0",this.txt.width=this.icon.width,this.txt.x=this.icon.x+(this.icon.width-this.txt.width)/2,this.txt.y=this.icon.y+(this.icon.height-this.txt.height)/2},e.prototype.setOnlinePeoples=function(t){this.txt.text="",this.txt.text="在线\n"+t.toString(),this.txt.x=this.icon.x+(this.icon.width-this.txt.width)/2,this.txt.y=this.icon.y+(this.icon.height-this.txt.height)/2},e}(egret.DisplayObjectContainer);t.OnlineUI=e,__reflect(e.prototype,"GameScenes.PlayTable.OnlineUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.playDiceInterval=Settings.GameSettingUtils.timeSetting.playDiceInterval,i.diceMoveInterval=Settings.GameSettingUtils.timeSetting.diceMoveInterval,i.setting=e,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(t){this.load(this.initMovieClip),this.timer=new egret.Timer(this.playDiceInterval,1)},e.prototype.initMovieClip=function(){var t=new egret.MovieClipDataFactory(this._mcData,this._mcTexture);this.role1=new egret.MovieClip(t.generateMovieClipData(this.setting.name)),this.role1.x=this.setting.pointX,this.role1.y=this.setting.pointY,this.role2=new egret.MovieClip(t.generateMovieClipData(this.setting.name)),this.role2.x=this.setting.pointX,this.role2.y=this.setting.pointY,this.addChild(this.role1),this.addChild(this.role2),this.role1.visible=!1,this.role2.visible=!1},e.prototype.play=function(t){var e=this;this.role1.visible=!0,this.role2.visible=!0,this.role1.gotoAndPlay(0,1.5),this.role2.gotoAndPlay(0,1.5);var i=Math.random()*(this.setting.areaWidth-this.role1.width)+this.setting.left,n=Math.random()*(this.setting.areaHeight-this.role1.height)+this.setting.top,s=Math.random()*(this.setting.areaWidth-this.role2.width)+this.setting.left,o=Math.random()*(this.setting.areaHeight-this.role2.height)+this.setting.top;egret.Tween.get(this.role1).to({x:i,y:n},this.diceMoveInterval).to({x:Math.random()*(this.setting.areaWidth-this.role1.width)+this.setting.left,y:Math.random()*(this.setting.areaHeight-this.role1.height)+this.setting.top},this.diceMoveInterval).to({x:Math.random()*(this.setting.areaWidth-this.role1.width)+this.setting.left,y:Math.random()*(this.setting.areaHeight-this.role1.height)+this.setting.top},this.diceMoveInterval),egret.Tween.get(this.role2).to({x:s,y:o},this.diceMoveInterval).to({x:Math.random()*(this.setting.areaWidth-this.role2.width)+this.setting.left,y:Math.random()*(this.setting.areaHeight-this.role2.height)+this.setting.top},this.diceMoveInterval).to({x:Math.random()*(this.setting.areaWidth-this.role2.width)+this.setting.left,y:Math.random()*(this.setting.areaHeight-this.role2.height)+this.setting.top},this.diceMoveInterval),this.role1.once(egret.Event.COMPLETE,function(){e.role1.visible=!1,e.role2.visible=!1,e.role1.x=e.setting.pointX,e.role1.y=e.setting.pointY,e.role2.x=e.setting.pointX,e.role2.y=e.setting.pointY,e.drawDice(t)},this)},e.prototype.drawDice=function(t){var e=this,i=CommonUtils.BitmapUtils.createBitmapByName(t[0]+"_png");this.addChild(i),i.x=this.setting.left+this.setting.dicePaddingX,i.y=this.setting.top+this.setting.dicePaddingY;var n=CommonUtils.BitmapUtils.createBitmapByName(t[1]+"_png");this.addChild(n),n.x=this.setting.left+this.setting.dicePaddingX+i.width+this.setting.dicePadding,n.y=this.setting.top+this.setting.dicePaddingY,this.timer.once(egret.TimerEvent.TIMER_COMPLETE,function(){e.removeChild(i),e.removeChild(n),i=null,n=null},this),this.timer.reset(),this.timer.start()},e.prototype.load=function(t){var e=0,i=this,n=function(){e++,2==e&&t.call(i)},s=new egret.URLLoader;s.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;this._mcTexture=e.data,n()},this),s.dataFormat=egret.URLLoaderDataFormat.TEXTURE;var o=new egret.URLRequest(this.setting.pngUrl);s.load(o);var s=new egret.URLLoader;s.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;this._mcData=JSON.parse(e.data),n()},this),s.dataFormat=egret.URLLoaderDataFormat.TEXT;var o=new egret.URLRequest(this.setting.jsonUrl);s.load(o)},e}(egret.DisplayObjectContainer);t.PlayDice=e,__reflect(e.prototype,"GameScenes.PlayTable.PlayDice")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.drawPositionView(),this.drawBetTF()},e.prototype.drawPositionView=function(){this.bitmap=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName),this.addChild(this.bitmap),this.bitmap.x=this.setting.left,this.bitmap.y=this.setting.top,this.cover=CommonUtils.BitmapUtils.createBitmapByName("发牌方遮罩_png"),this.addChild(this.cover),this.cover.x=this.bitmap.x-30,this.cover.y=this.bitmap.y-30,this.cover.width=this.bitmap.width+60,this.cover.height=this.bitmap.height+60,this.cover.visible=!1},e.prototype.drawBetTF=function(){this.betTF=new egret.TextField,this.addChild(this.betTF),this.betTF.size=this.setting.textSize,this.betTF.textColor=this.setting.textColor,this.betTF.textAlign=egret.HorizontalAlign.LEFT,this.betTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.betTF.text="0",this.betTF.fontFamily=this.setting.font,this.betTF.x=this.setting.left+this.setting.textX,this.betTF.y=this.setting.top+(this.setting.titleHeight-this.betTF.height)/2},e.prototype.setTotleBet=function(t){t.toString().length>=7?this.betTF.text=CommonUtils.NumberUtils.shortNumber(t):this.betTF.text=CommonUtils.NumberUtils.formatNumber(t)},e}(egret.DisplayObjectContainer);t.PlayerPosition=e,__reflect(e.prototype,"GameScenes.PlayTable.PlayerPosition")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);t.PlayerResultUI=e,__reflect(e.prototype,"GameScenes.PlayTable.PlayerResultUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.pokerPadding=30,i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.createPoker()},e.prototype.dealCard=function(t,e){var i=this,n=Math.floor(t/4);egret.Tween.get(this.pokerArr[51-t]).to({x:e.x+n*this.pokerPadding,y:e.y},300).call(function(){i.setChildIndex(i.pokerArr[51-t],t)})},e.prototype.refreshCards=function(){for(var t=0;51>t;t++)this.setChildIndex(this.pokerArr[t],t)},e.prototype.createPoker=function(){this.pokerArr=new Array;for(var t=0;52>t;t++){var e=CommonUtils.BitmapUtils.createBitmapByName(this.setting.iconName);e.x=this.setting.left,e.y=this.setting.top-Math.floor(t/13)*this.setting.padding,this.addChild(e),this.pokerArr.push(e)}},e}(egret.DisplayObjectContainer);t.PokerBg=e,__reflect(e.prototype,"GameScenes.PlayTable.PokerBg")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e,i){var n=t.call(this)||this;return n._clipWidth=306,n._clipHeight=183,n.pokerWidth=78,n.duration=300,n.setting=e,n.view=i,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(t){this.load(this.initMovieClip)},e.prototype.initMovieClip=function(){var t=new egret.MovieClipDataFactory(this._mcData,this._mcTexture);this.role=new egret.MovieClip(t.generateMovieClipData(this.setting.name)),this.role.anchorOffsetX=this._clipWidth/2,this.role.anchorOffsetY=this._clipHeight/2,this.role.x=Settings.GameSettingUtils.gameSetting.globalWidth/2,this.role.y=Settings.GameSettingUtils.gameSetting.globalHeight/2,this.addChild(this.role),this.role.visible=!1},e.prototype.shufflePoker=function(){var t=this,e=this;this.role.visible=!0,this.role.gotoAndPlay(0,1),this.role.addEventListener(egret.Event.COMPLETE,function(){egret.Tween.get(e.role).to({rotation:-90},Settings.GameSettingUtils.timeSetting.pokerRotationInterval).wait(Settings.GameSettingUtils.timeSetting.pokerWaitInterval).to({x:t.setting.pointY+t._clipHeight/2-t.role.height-t.pokerWidth,y:t.setting.pointY+t._clipWidth/2-t.role.width-t.setting.padding},t.duration).call(function(){e.role.visible=!1,e.role.rotation=0,e.role.x=Settings.GameSettingUtils.gameSetting.globalWidth/2,e.role.y=Settings.GameSettingUtils.gameSetting.globalHeight/2,e.view.drawPokerBg(),e.view.startPutBet(),e.view.showStartBet(),e.view.presenter.startSendPokerCountdown(),e.view.betCoinContainer.checkBetNum(0,e.view.presenter.currentBonus,e.view.presenter.maxOdds)})},this)},e.prototype.load=function(t){var e=0,i=this,n=function(){e++,2==e&&t.call(i)},s=new egret.URLLoader;s.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;this._mcTexture=e.data,n()},this),s.dataFormat=egret.URLLoaderDataFormat.TEXTURE;var o=new egret.URLRequest("resource/assets/images/animaition/洗牌.png");s.load(o);var s=new egret.URLLoader;s.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;this._mcData=JSON.parse(e.data),n()},this),s.dataFormat=egret.URLLoaderDataFormat.TEXT;var o=new egret.URLRequest("resource/assets/images/animaition/洗牌.json");s.load(o)},e}(egret.DisplayObjectContainer);t.Shuuffle=e,__reflect(e.prototype,"GameScenes.PlayTable.Shuuffle")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.setting=e,i.once(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.prototype.onAddToStage=function(){this.drawBg(),this.drawTitle(),this.drawIssueTF(),this.drawBackBtn()},e.prototype.drawBg=function(){var t=new egret.Shape;t.graphics.beginFill(this.setting.titleBgColor,this.setting.titleBgAlpha),t.graphics.drawRect(0,0,Settings.GameSettingUtils.gameSetting.globalWidth,this.setting.titleHeight),t.graphics.endFill(),this.addChild(t)},e.prototype.drawTitle=function(){this.title=new egret.TextField,this.title.size=this.setting.textSize,this.title.textColor=this.setting.textColor,this.title.textAlign=egret.HorizontalAlign.CENTER,this.title.verticalAlign=egret.VerticalAlign.MIDDLE,this.title.fontFamily=this.setting.font,this.title.text=this.setting.titleText,this.title.x=(Settings.GameSettingUtils.gameSetting.globalWidth-this.title.width)/2,this.title.y=this.setting.top,this.addChild(this.title)},e.prototype.drawIssueTF=function(){this.issueTF=new egret.TextField,this.addChild(this.issueTF),this.issueTF.size=this.setting.text1Size,this.issueTF.textColor=this.setting.text1Color,this.issueTF.textAlign=egret.HorizontalAlign.CENTER,this.issueTF.verticalAlign=egret.VerticalAlign.MIDDLE,this.issueTF.fontFamily=this.setting.font,this.issueTF.text=" ",this.issueTF.x=(Settings.GameSettingUtils.gameSetting.globalWidth-this.issueTF.width)/2,this.issueTF.y=this.setting.top+this.title.height+this.setting.padding},e.prototype.drawBackBtn=function(){this.cacheAsBitmap=!0,this.backBtn=CommonUtils.BitmapUtils.createBitmapByName("nav-arrow_png"),this.addChild(this.backBtn),this.backBtn.touchEnabled=!0,this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("back btn tapped."),NativeClose(),ocClick(),Server.Connector.getGameClient().close()},this),this.backBtn.x=0,this.backBtn.y=0},e.prototype.setTssue=function(t){this.issueTF.text="",this.issueTF.text="第"+t+"期",this.issueTF.x=(Settings.GameSettingUtils.gameSetting.globalWidth-this.issueTF.width)/2,this.issueTF.y=this.setting.top+this.title.height+this.setting.padding},e}(egret.DisplayObjectContainer);t.TitleUI=e,__reflect(e.prototype,"GameScenes.PlayTable.TitleUI")}(e=t.PlayTable||(t.PlayTable={}))}(GameScenes||(GameScenes={}));var CommonUtils;!function(t){var e=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t}();t.BitmapUtils=e,__reflect(e.prototype,"CommonUtils.BitmapUtils")}(CommonUtils||(CommonUtils={}));var GameScenes;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.view=e,i}return __extends(e,t),e}(t.BasePresenter);t.HelpPresenter=e,__reflect(e.prototype,"GameScenes.HelpPresenter")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.view=e,i.historyData=new Array,i}return __extends(e,t),e.prototype.getHistoryRecord=function(t){Server.Connector.getGameClient().getHistoryRecord(t,10,this)},e.prototype.getMoreHistoryRecord=function(t){Server.Connector.getGameClient().getHistoryRecord(t,10,this)},e.prototype.onGetHistoryRecordFailed=function(t){},e.prototype.onGetHistoryRecordSuccess=function(t){var e=this;t&&t.length>0&&t.forEach(function(t){e.historyData.push(t)}),this.view.setHistoryRowData(t)},e}(t.BasePresenter);t.HistoryPresenter=e,__reflect(e.prototype,"GameScenes.HistoryPresenter")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.openCardCount=0,i.anmaitonDuration=14,i.shuffleDuration=4,i.currentBonus=0,i.view=e,i}return __extends(e,t),e.prototype.init=function(){Settings.GameSettingUtils.globalScale=this.view.stage.stageWidth/Settings.GameSettingUtils.gameSetting.globalWidth,this.view.initView(),this.countdownTimer=new egret.Timer(1e3,0),this.countdownTimer.addEventListener(egret.TimerEvent.TIMER,this.onCountdownTimer,this),this.sendCardTimer=new egret.Timer(Settings.GameSettingUtils.timeSetting.sendPokerInterval,0),this.sendCardTimer.addEventListener(egret.TimerEvent.TIMER,this.onSendCardTimer,this),this.gameTimer=new egret.Timer(1e3,0),this.gameTimer.addEventListener(egret.TimerEvent.TIMER,this.onGameTimer,this),this.view.stage.addEventListener(egret.Event.DEACTIVATE,this.onDeactivate,this),this.view.stage.addEventListener(egret.Event.ACTIVATE,this.onActivate,this),this.openCardTimer=new egret.Timer(1e3,4),this.openCardTimer.addEventListener(egret.TimerEvent.TIMER,this.openCard,this),this.diceTimer=new egret.Timer(3e3,1),this.diceTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.playDiceFinish,this),this.dices=new Array,this.myBetResultList=new Array,this.betResults=new Array},e.prototype.startEnterGameServer=function(){Server.Connector.getGameClient().enter(CommonUtils.AccountUtils.getAccountToken(),this)},e.prototype.startBeting=function(t){this.view.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.view.putBet,this.view),Server.Connector.getGameClient().bet(t,this.scheduleId,this)},e.prototype.onBetSuccess=function(t){this.view.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.view.putBet,this.view),this.view.ownBetNumUI.setTotleBetNum(Number(t.CurrentBonus));var e=0;t.MyBetList.forEach(function(t){e+=t}),this.view.betCoinContainer.checkBetNum(e,t.CurrentBonus,this.maxOdds),this.currentBonus=Number(t.CurrentBonus),this.view.putBetOn(),t.MyBetList&&0!=t.MyBetList.length&&(this.view.showPlayerBetInfo(t.MyBetList),t.OptionBetList&&0!=t.OptionBetList.length&&this.view.showTotleBetInfo(t.OptionBetList))},e.prototype.onBetFailed=function(t){this.view.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.view.putBet,this.view),"余额不足！"==t.Message&&this.view.showNotEnough()},e.prototype.onUserEnterSuccess=function(t){this.enterData=t,this.view.drawScene(t),this.view.registEvents(),this.registDataReceiveHandlers(),this.registGameClientReceiveMsgCallback(),this.view.onLineIcon.setOnlinePeoples(t.Data.UserCount),this.view.ownBetNumUI.setTotleBetNum(t.Data.CurrentBonus),this.maxOdds=t.Data.MaxOdds;var e=0;switch(t.Data.MyBetList&&t.Data.MyBetList.forEach(function(t){e+=t}),this.currentBonus=t.Data.CurrentBonus,t.Data.CurrentSchedule.State){case 0:if(0==this.view.betCoinContainer.betBitmapIndex?500<=this.currentBonus&&this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex):this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex),this.view.playTableTitle.setTssue(t.Data.PrevSchedule.ScheduleNumber),this.currentRoundState=Model.RoundState.Unstarted,this.countdownSeconds=t.Data.CurrentSchedule.CountDown,this.gameCountDownSeconds=t.Data.CurrentSchedule.CountDown-this.shuffleDuration,this.gameTimer.start(),this.view.betCoinContainer.unTouchEable(),this.view.drawPokerBg(),!t.Data.MyBetList)return;if(0==t.Data.MyBetList.length)return;if(t.Data.MyBetList.length>0&&this.view.showPlayerBetInfo(t.Data.MyBetList),!t.Data.OptionBetList)return;if(0==t.Data.OptionBetList.length)return;t.Data.OptionBetList.length>0&&this.view.showTotleBetInfo(t.Data.OptionBetList),this.view.drawBet(t.Data.OptionBetNumberList),t.Data.CardData.HandList.length>0&&(this.resultHandData=t.Data.CardData.HandList,this.openedCard());break;case 1:if(!t.Data.MyBetList)return;if(0==t.Data.MyBetList.length)return;if(t.Data.MyBetList.length>0&&this.view.showPlayerBetInfo(t.Data.MyBetList),!t.Data.OptionBetList)return;if(0==t.Data.OptionBetList.length)return;if(t.Data.OptionBetList.length>0&&this.view.showTotleBetInfo(t.Data.OptionBetList),this.view.drawBet(t.Data.OptionBetNumberList),0==this.view.betCoinContainer.betBitmapIndex?500<=this.currentBonus&&this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex):this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex),this.view.playTableTitle.setTssue(t.Data.CurrentSchedule.ScheduleNumber),this.scheduleId=t.Data.CurrentSchedule.ScheduleId,this.countdownSeconds=t.Data.CurrentSchedule.CountDown-this.shuffleDuration,this.gameCountDownSeconds=t.Data.CurrentSchedule.CountDown-this.shuffleDuration,this.currentRoundState=Model.RoundState.Started,this.view.drawPokerBg(),this.view.startPutBet(),this.view.showBet(),this.startSendPokerCountdown(),!t.Data.MyBetList)return;if(0==t.Data.MyBetList.length)return;if(t.Data.MyBetList.length>0&&this.view.showPlayerBetInfo(t.Data.MyBetList),!t.Data.OptionBetList)return;if(0==t.Data.OptionBetList.length)return;t.Data.OptionBetList.length>0&&this.view.showTotleBetInfo(t.Data.OptionBetList);break;case 2:this.view.playTableTitle.setTssue(t.Data.CurrentSchedule.ScheduleNumber),this.currentRoundState=Model.RoundState.Frozen,this.view.drawPokerBg(),this.view.stopPutBet(),this.view.betCoinContainer.unTouchEable(),this.view.showInfo("请耐心等待下一局")}this.view.betCoinContainer.checkBetNum(e,t.Data.CurrentBonus,this.maxOdds),t.Data.CurrentBonus<=100*this.maxOdds-1?this.view.showWantageAlert(this.maxOdds):this.view.hideWantageAlert()},e.prototype.registDataReceiveHandlers=function(){ReceiveDataHandlers.ReceiveDataManager.initBusinessHandlers(this.view)},e.prototype.registGameClientReceiveMsgCallback=function(){var t=this;egret.log("消息推送事件");var e=this;Server.Connector.getGameClient().on(Server.BaseClient.EVENT_HEART_BEAT_TIMEOUT,function(t){e.onSocketException()}),Server.Connector.getGameClient().on(Server.BaseClient.EVENT_CLOSE,function(t){e.onSocketException()}),Server.Connector.getGameClient().on(Server.BaseClient.EVENT_IO_ERROR,function(t){e.onSocketException()}),Server.Connector.getGameClient().setOnAccountEnter(function(t){e.view.onLineIcon.setOnlinePeoples(t.UserCount),egret.log("用户进入")}),Server.Connector.getGameClient().setOnAccountLeave(function(t){e.view.onLineIcon.setOnlinePeoples(t.UserCount),egret.log("用户离开")}),Server.Connector.getGameClient().setOnUserBet(function(t){console.log("data:"+t),egret.log("用户下注"),e.view.showTotleBetInfo(t.OptionBetList),e.view.putOtherBetOn(t.BetData.BetContent)}),Server.Connector.getGameClient().setOnStartSchedule(function(i){for(egret.log("开始新的一期"),e.view.alert.bitmapText&&"请耐心等待下一局"==e.view.alert.bitmapText.text&&e.view.removeAlert(),0==e.view.betCoinContainer.betBitmapIndex?500<=e.currentBonus&&e.view.betCoinContainer.resetBet(e.view.betCoinContainer.betBitmapIndex):e.view.betCoinContainer.resetBet(e.view.betCoinContainer.betBitmapIndex),e.view.betCoinContainer.checkBetNum(0,e.currentBonus,e.maxOdds),e.currentBonus<=100*e.maxOdds-1?e.view.showWantageAlert(e.maxOdds):e.view.hideWantageAlert();e.betResults.length>0;)e.betResults.pop();
e.view.showPlayerBetInfo([0,0,0,0,0]),e.view.showTotleBetInfo([0,0,0,0,0]),e.scheduleId=i.scheduleData.ScheduleId,e.view.playTableTitle.setTssue(i.scheduleData.ScheduleNumber),e.countdownSeconds=i.scheduleData.CountDown-t.shuffleDuration,e.currentRoundState=i.scheduleData.State,console.log("data:"+i)}),Server.Connector.getGameClient().setOnFreezeSchedule(function(t){console.log("data:"+t)}),Server.Connector.getGameClient().setOnSettleSchedule(function(t){egret.log("结算"),e.view.contains(e.view.alert)&&e.view.removeAlert(),e.scheduleId=t.scheduleData.ScheduleId,e.resultHandData=t.cardData.HandList,e.countdownSeconds=t.scheduleData.CountDown,e.gameCountDownSeconds=t.scheduleData.CountDown-e.anmaitonDuration,e.currentRoundState=t.scheduleData.Stage,e.dices=t.cardData.Dice,e.myBetResultList=t.MyBetResultList,t.MyBetResultList&&(e.currentBonus=t.CurrentBonus),t.cardData.HandList.forEach(function(t){t.WinStatus.length>0&&e.betResults.push(t.WinStatus)}),e.view.setChildIndex(e.view.playDiceUI,e.view.numChildren-1),e.view.playDiceUI.play(e.dices),e.diceTimer.reset(),e.diceTimer.start()})},e.prototype.onGameTimer=function(t){return this.view.countDownTimer.visible=!1,this.countdownTimer.stop(),this.gameCountDownSeconds<=0?(this.gameTimer.stop(),this.view.cleanPlayTableSence(),this.view.removeAlert(),void this.view.shuffleUI.shufflePoker()):(this.view.showInfo("下一局倒计时 ",this.gameCountDownSeconds),void this.gameCountDownSeconds--)},e.prototype.startSendPokerCountdown=function(){this.countdownTimer.start()},e.prototype.onCountdownTimer=function(t){if(this.countdownSeconds>0&&(this.view.countDownTimer.visible=!0),this.countdownSeconds<=0){if(this.countdownTimer.stop(),this.view.countDownTimer.visible=!1,this.view.countDownTimer.showCountdownSeconds(this.countdownSeconds,this.currentRoundState),this.currentRoundState==Model.RoundState.Unstarted)return;if(this.currentRoundState==Model.RoundState.Started)return this.view.showStopBet(),this.view.stopPutBet(),void this.view.betCoinContainer.unTouchEable();if(this.currentRoundState==Model.RoundState.Frozen)return}this.view.countDownTimer.showCountdownSeconds(this.countdownSeconds,this.currentRoundState),this.countdownSeconds--},e.prototype.startBetCountdown=function(){this.currentRoundState=Model.RoundState.Started,this.countdownTimer.start()},e.prototype.startSendCard=function(){this.view.pokerBg.refreshCards(),this.cardIndex=0,this.startSendCardPos=this.getStartPosition(),this.sendCardTimer.start()},e.prototype.showPlyerCover=function(){var t=this,e=(this.dices[0]+this.dices[1]-1)%4;this.view.showPlyerCover(e);var i=new egret.Timer(1e3,1);i.once(egret.TimerEvent.TIMER_COMPLETE,function(){t.startSendCard()},this),i.start()},e.prototype.getStartPosition=function(){var t=(this.dices[0]+this.dices[1]-1)%4;return t},e.prototype.onSendCardTimer=function(t){return this.cardIndex>=20?(this.sendCardTimer.stop(),this.openCardCount=0,this.openCardTimer.reset(),this.openCardTimer.start(),void this.view.hidePlayerCover()):(this.view.sendCard(this.cardIndex,this.startSendCardPos),this.cardIndex++,void(this.startSendCardPos=(this.startSendCardPos+1)%4))},e.prototype.openedCard=function(){for(var t=0;t<this.resultHandData.length;t++){var e=this.resultHandData[t];this.view.openCard(t,e),this.view.showResult(e.WinStatus,t)}},e.prototype.openCard=function(t){var e=this.resultHandData[(this.openCardCount+1)%4];if(this.view.openCard((this.openCardCount+1)%4,e),this.openCardCount++,this.openCardCount>=4){for(var i=0;6>i;i++)e=this.resultHandData[i],this.view.showResult(e.WinStatus,i);this.settleAccounts(this.betResults)}},e.prototype.settleAccounts=function(t){var e=0;this.myBetResultList&&(this.myBetResultList.forEach(function(t){t.WinNumber>0&&(e+=t.WinNumber)}),this.view.ownBetNumUI.setTotleBetNum(this.currentBonus)),this.view.betAnimation(e,t),this.gameTimer.start()},e.prototype.playDiceFinish=function(){this.showPlyerCover()},e.prototype.onUserEnterFailed=function(){},e.prototype.onUserReEnterSuccess=function(t){console.info("用户重连成功"+t),egret.log("用户重连成功"),this.view.hideReConnect(),this.setReEnterSuccess(t)},e.prototype.onDeactivate=function(){console.warn("转入后台运行"),egret.log("转入后台运行"),this.closeConnect(),this.view.betCoinContainer&&(this.view.betCoinContainer.betNum=0,this.view.betCoinContainer.betBitmapIndex=0)},e.prototype.onActivate=function(){console.warn("转到前台运行"),egret.log("转到前台运行")},e.prototype.closeConnect=function(){Server.Connector&&Server.Connector.getGameClient()&&Server.Connector.getGameClient().close()},e.prototype.onSocketException=function(){Server.Connector.getGameClient().close(),Server.Connector.getGameClient().State=Server.ClientState.Disconnected,Server.Connector.startReconnectTimer(this),this.view.showReConnect()},e.prototype.setReEnterSuccess=function(t){this.view.cleanPlayTableSence(),this.view.onLineIcon.setOnlinePeoples(t.UserCount),this.view.ownBetNumUI.setTotleBetNum(t.CurrentBonus),this.maxOdds=t.MaxOdds;var e=0;switch(t.MyBetList&&t.MyBetList.forEach(function(t){e+=t}),this.currentBonus=t.CurrentBonus,t.CurrentSchedule.State){case 0:if(0==this.view.betCoinContainer.betBitmapIndex?500<=this.currentBonus&&this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex):this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex),this.view.playTableTitle.setTssue(t.PrevSchedule.ScheduleNumber),this.currentRoundState=Model.RoundState.Unstarted,this.countdownSeconds=t.CurrentSchedule.CountDown,this.gameCountDownSeconds=t.CurrentSchedule.CountDown-this.shuffleDuration,this.gameTimer.start(),this.view.betCoinContainer.unTouchEable(),this.view.drawPokerBg(),!t.MyBetList)return;if(0==t.MyBetList.length)return;if(t.MyBetList.length>0&&this.view.showPlayerBetInfo(t.MyBetList),!t.OptionBetList)return;if(0==t.OptionBetList.length)return;t.OptionBetList.length>0&&this.view.showTotleBetInfo(t.OptionBetList),this.view.drawBet(t.OptionBetNumberList),t.CardData.HandList.length>0&&(this.resultHandData=t.CardData.HandList,this.openedCard());break;case 1:if(!t.MyBetList)return;if(0==t.MyBetList.length)return;if(t.MyBetList.length>0&&this.view.showPlayerBetInfo(t.MyBetList),!t.OptionBetList)return;if(0==t.OptionBetList.length)return;if(t.OptionBetList.length>0&&this.view.showTotleBetInfo(t.OptionBetList),this.view.drawBet(t.OptionBetNumberList),0==this.view.betCoinContainer.betBitmapIndex?500<=this.currentBonus&&this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex):this.view.betCoinContainer.resetBet(this.view.betCoinContainer.betBitmapIndex),this.view.playTableTitle.setTssue(t.CurrentSchedule.ScheduleNumber),this.scheduleId=t.CurrentSchedule.ScheduleId,this.countdownSeconds=t.CurrentSchedule.CountDown-this.shuffleDuration,this.gameCountDownSeconds=t.CurrentSchedule.CountDown-this.shuffleDuration,this.currentRoundState=Model.RoundState.Started,this.view.drawPokerBg(),this.view.startPutBet(),this.view.showBet(),this.startSendPokerCountdown(),!t.MyBetList)return;if(0==t.MyBetList.length)return;if(t.MyBetList.length>0&&this.view.showPlayerBetInfo(t.MyBetList),!t.OptionBetList)return;if(0==t.OptionBetList.length)return;t.OptionBetList.length>0&&this.view.showTotleBetInfo(t.OptionBetList);break;case 2:this.view.playTableTitle.setTssue(t.CurrentSchedule.ScheduleNumber),this.currentRoundState=Model.RoundState.Frozen,this.view.drawPokerBg(),this.view.stopPutBet(),this.view.betCoinContainer.unTouchEable(),this.view.showInfo("请耐心等待下一局")}this.view.betCoinContainer.checkBetNum(e,t.CurrentBonus,this.maxOdds),t.CurrentBonus<=100*this.maxOdds-1?this.view.showWantageAlert(this.maxOdds):this.view.hideWantageAlert()},e}(t.BasePresenter);t.PlayTablePresenter=e,__reflect(e.prototype,"GameScenes.PlayTablePresenter")}(GameScenes||(GameScenes={}));var GameScenes;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.view=e,i}return __extends(e,t),e.prototype.getTrend=function(){Server.Connector.getGameClient().getTrend(this)},e.prototype.onGetTrendFailed=function(t){},e.prototype.onGetTrendSuccess=function(t){this.view.setTrendRowData(t.Data)},e}(t.BasePresenter);t.TrendPresenter=e,__reflect(e.prototype,"GameScenes.TrendPresenter")}(GameScenes||(GameScenes={}));var Model;!function(t){var e=function(){function t(){}return t}();t.GameModels=e,__reflect(e.prototype,"Model.GameModels");var i=function(){function t(){}return t}();t.JsonObject=i,__reflect(i.prototype,"Model.JsonObject");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);t.TrendModel=n,__reflect(n.prototype,"Model.TrendModel");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);t.HistoryModel=s,__reflect(s.prototype,"Model.HistoryModel");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);t.OptionModel=o,__reflect(o.prototype,"Model.OptionModel");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);t.BetModel=a,__reflect(a.prototype,"Model.BetModel")}(Model||(Model={}));var Model;!function(t){var e;!function(t){t[t.Unstarted=0]="Unstarted",t[t.Started=1]="Started",t[t.Frozen=2]="Frozen",t[t.Settled=3]="Settled",t[t.Open=4]="Open"}(e=t.RoundState||(t.RoundState={}))}(Model||(Model={}));var ReceiveDataHandlers;!function(ReceiveDataHandlers){var BaseReceiveDataHandler=function(){function BaseReceiveDataHandler(t){this.scene=t}return BaseReceiveDataHandler.prototype.handleReceiveData=function(data){if(!data)return!0;if(!data.msg)return!0;var obj=null;try{obj=eval("("+data.msg+")")}catch(err){return this.failedCallback||this.failedCallback("返回数据的data.msg不是json格式"),!0}return obj?""==this.supportedType?(this.successCallback&&this.successCallback(obj.data),!0):obj.type!=this.supportedType?!1:(this.successCallback&&this.successCallback(obj.data),!0):(this.failedCallback||this.failedCallback("返回数据的data.msg没有被成功解析为对象"),!0)},BaseReceiveDataHandler}();ReceiveDataHandlers.BaseReceiveDataHandler=BaseReceiveDataHandler,__reflect(BaseReceiveDataHandler.prototype,"ReceiveDataHandlers.BaseReceiveDataHandler",["ReceiveDataHandlers.IReceiveDataHandler"])}(ReceiveDataHandlers||(ReceiveDataHandlers={}));var ReceiveDataHandlers;!function(t){var e=function(){function t(){}return t.pushHandler=function(e){t.handlers||(t.handlers=[]),t.handlers.push(e)},t.handleManager=function(e){if(t.handlers)for(var i=0;i<t.handlers.length;i++)if(t.handlers[i].handleReceiveData(e))return},t.initBusinessHandlers=function(e){t.handlers||(t.handlers=[])},t}();t.ReceiveDataManager=e,__reflect(e.prototype,"ReceiveDataHandlers.ReceiveDataManager")}(ReceiveDataHandlers||(ReceiveDataHandlers={}));var CommonUtils;!function(t){var e=function(){function t(){}return t.toStringWithPrefixNumber=function(t,e,i){var n=t.toString();return n.length>=i?n:("0000000000"+n).substr(-i)},t.formatNumber=function(t){if(1e3>t)return t.toString();for(var e="",i=t,n=0;i>0;)n>0&&n%3==0&&(e=","+e),e=i%10+e,i=Math.floor(i/10),n++;return e},t.shortNumber=function(t){return 1e4>t?t.toString():Number((t/1e4).toFixed(2).toString().split(".")[1])>=10&&Number((t/1e4).toFixed(2).toString().split(".")[1])<100&&"0"==(t/1e4).toFixed(2).toString().split(".")[1].substr(1,2)?(t/1e4).toFixed(1)+"w":Number((t/1e4).toFixed(2).toString().split(".")[1])>=1&&Number((t/1e4).toFixed(2).toString().split(".")[1])<10||Number((t/1e4).toFixed(2).toString().split(".")[1])>=10&&Number((t/1e4).toFixed(2).toString().split(".")[1])<100&&"0"!=(t/1e4).toFixed(2).toString().split(".")[1].substr(1,2)?(t/1e4).toFixed(2)+"w":Math.floor(t/1e4)+"w"},t}();t.NumberUtils=e,__reflect(e.prototype,"CommonUtils.NumberUtils")}(CommonUtils||(CommonUtils={}));var Server;!function(t){var e=function(){function t(){}return t.Success=200,t.ServerError=500,t}();t.RequestState=e,__reflect(e.prototype,"Server.RequestState");var i=function(){function i(){}return i.getGameClient=function(){return i.gameClient},i.initConnector=function(e){this.gateServerSetting=e,this.gateClient=new t.GateClient},i.startConnectToGateServer=function(t){return null==this.gateServerSetting?void t.onGateServerConnectFailed("gate server setting is not setted."):(t.onBeforeGateServerConnected(),void this.gateClient.init({host:this.gateServerSetting.ip,port:this.gateServerSetting.port},function(){t.onGateServerConnected(),i.onGateServerConnected(t)}))},i.startConnectToGameServer=function(e){return null==i.gameServerSettingList?void e.onConnectToGameServerFailed("没有可用的游戏服务器"):(i.gameClient=new t.GameClient,void i.connectedToGameServer(0,e))},i.connectedToGameServer=function(t,e){i.currentGameServerSetting=i.gameServerSettingList[t],i.gameClient.init({host:i.currentGameServerSetting.HostAddress,port:i.currentGameServerSetting.Port},function(){e.onGameServerConnected()})},i.onGateServerConnected=function(t){console.info("gate server connect success, start to get all game entry"),this.gateClient.getAllEntry({},function(n){return n.Code==e.Success?n.Data&&0!=n.Data.length?(i.gameServerSettingList=n.Data,t.onGetGameServerSuccess(),void i.startConnectToGameServer(t)):void t.onGetGameServerFailed("没有可用的游戏服务器"):void t.onGetGameServerFailed(n.Data)})},i.startReconnectTimer=function(t){i.timer||(i.timer=new egret.Timer(5e3,1),i.timer.addEventListener(egret.TimerEvent.TIMER,function(){i.reConnectToGameServer(null,t)},t)),i.timer.running||(i.timer.reset(),i.timer.start())},i.reConnectToGameServer=function(e,n){i.gameClient.State==t.ClientState.Disconnected&&i.gameClient.reConnect(i.currentGameServerSetting.HostAddress,i.currentGameServerSetting.Port,function(t){t&&(i.timer.stop(),i.gameClient.reEnter(CommonUtils.AccountUtils.getAccountToken(),n))})},i.onUserEnterSuccess=function(t,e){e.onUserEnterSuccess(t)},i.onUserEnterFailed=function(t,e){e.onConnectFailed&&e.onConnectFailed(t)},i.onUserReEnterSuccess=function(t,e){i.timer&&i.timer.stop(),e.onUserReEnterSuccess(t)},i.onUserReEnterFailed=function(t,e){e.onReconnectFailed&&e.onReconnectFailed(t)},i}();t.Connector=i,__reflect(i.prototype,"Server.Connector")}(Server||(Server={}));var Server;!function(t){var e=function(){function t(){}return t.Enter="Enter",t.Bet="Bet",t.Chart="Chart",t.History="History",t}();__reflect(e.prototype,"Route");var i=function(){function t(){}return t.OnAccountEnter="AccountEnter",t.OnAccountLeave="AccountLeave",t.OnUserBet="UserBet",t.OnStartSchedule="StartSchedule",t.OnFreezeSchedule="FreezeSchedule",t.OnSettleSchedule="SettleSchedule",t}();__reflect(i.prototype,"GameEvents");var n=function(n){function s(){return n.call(this)||this}return __extends(s,n),s.prototype.enter=function(i,n){return this.State==t.ClientState.Connedted?void this.request({Route:e.Enter,Data:i},function(e){return e?e.Code!=t.RequestState.Success?void t.Connector.onUserEnterFailed(e,n):void t.Connector.onUserEnterSuccess(e,n):void t.Connector.onUserEnterFailed("登录游戏服务器失败，用户验证不通过",n)}):void setInterval(function(){this.enter(i,n)},1e3)},s.prototype.reEnter=function(i,n){return this.State==t.ClientState.Connedted?void this.request({Route:e.Enter,Data:i},function(e){return e?e.Code!=t.RequestState.Success?void t.Connector.onUserReEnterFailed(e.Data,n):void t.Connector.onUserReEnterSuccess(e.Data,n):void t.Connector.onUserReEnterFailed("登录游戏服务器失败，用户验证不通过",n)}):void setTimeout(function(){this.reEnter(i,n)},1e3)},s.prototype.bet=function(i,n,s){if(this.State==t.ClientState.Connedted){var o={ScheduleId:n,BetContent:i};return void this.request({Route:e.Bet,Data:o},function(e){return e?e.Code!=t.RequestState.Success?void s.onBetFailed(e.Data):void s.onBetSuccess(e.Data):void s.onBetFailed(e.Data)})}},s.prototype.getTrend=function(i){this.State==t.ClientState.Connedted&&this.request({Route:e.Chart},function(e){return e?e.Code!=t.RequestState.Success?void i.onGetTrendFailed(e):void i.onGetTrendSuccess(e):void i.onGetTrendFailed(e)}),setTimeout(function(){this.getTrend(i)},1e3)},s.prototype.getHistoryRecord=function(i,n,s){var o={Count:n,ScheduleId:i};this.request({Route:e.History,Data:o},function(e){return e?e.Code!=t.RequestState.Success?void s.onGetHistoryRecordFailed(e):void s.onGetHistoryRecordSuccess(e.Data):void s.onGetHistoryRecordFailed(e)})},s.prototype.setOnAccountEnter=function(t){this.on(i.OnAccountEnter,t)},s.prototype.setOnAccountLeave=function(t){this.on(i.OnAccountLeave,t)},s.prototype.setOnUserBet=function(t){this.on(i.OnUserBet,t)},s.prototype.setOnStartSchedule=function(t){this.on(i.OnStartSchedule,t)},s.prototype.setOnFreezeSchedule=function(t){this.on(i.OnFreezeSchedule,t)},s.prototype.setOnSettleSchedule=function(t){this.on(i.OnSettleSchedule,t)},s}(t.BaseClient);t.GameClient=n,__reflect(n.prototype,"Server.GameClient")}(Server||(Server={}));var Server;!function(t){var e=function(){function t(){}return t.GetAllEntry="GetAllEntry",t}();__reflect(e.prototype,"Route");var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.getAllEntry=function(t,i){this.request({Route:e.GetAllEntry,Data:null},i)},i}(t.BaseClient);t.GateClient=i,__reflect(i.prototype,"Server.GateClient")}(Server||(Server={}));var Settings;!function(t){var e=function(){function t(){}return t}();t.GameSettingUtils=e,__reflect(e.prototype,"Settings.GameSettingUtils");var i=function(){function t(){}return t}();t.GameSetting=i,__reflect(i.prototype,"Settings.GameSetting")}(Settings||(Settings={}));var Settings;!function(t){var e=function(){function t(){}return t.DEFAULE_STAGE_WIDTH=750,t}();t.InitSetting=e,__reflect(e.prototype,"Settings.InitSetting")}(Settings||(Settings={}));var TransmissionPackage;!function(t){var e=function(){function t(){}return t}();t.JsonObject=e,__reflect(e.prototype,"TransmissionPackage.JsonObject");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(e);t.BetItem=i,__reflect(i.prototype,"TransmissionPackage.BetItem")}(TransmissionPackage||(TransmissionPackage={}));